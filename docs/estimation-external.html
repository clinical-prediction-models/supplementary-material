<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>14 Estimation with External Information | Clinical prediction models</title>
  <meta name="description" content="14 Estimation with External Information | Clinical prediction models" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="14 Estimation with External Information | Clinical prediction models" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="clinical-prediction-models/supplementary-material" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="14 Estimation with External Information | Clinical prediction models" />
  
  
  

<meta name="author" content="Ewout Steyerberg" />


<meta name="date" content="2023-01-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="estimation.html"/>
<link rel="next" href="evaluation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Clinical Prediction Models</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="part"><span><b>I Part I: Prediction models in medicine</b></span></li>
<li class="chapter" data-level="2" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>2</b> Applications of Prediction Models</a></li>
<li class="chapter" data-level="3" data-path="design.html"><a href="design.html"><i class="fa fa-check"></i><b>3</b> Study Design for Prediction Modeling</a></li>
<li class="chapter" data-level="4" data-path="statmods.html"><a href="statmods.html"><i class="fa fa-check"></i><b>4</b> Statistical Models for Prediction</a></li>
<li class="chapter" data-level="5" data-path="overfitting.html"><a href="overfitting.html"><i class="fa fa-check"></i><b>5</b> Overfitting and Optimism in Prediction Models</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#figures-5.2-to-5.5"><i class="fa fa-check"></i>Figures 5.2 to 5.5</a>
<ul>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#fig-5.2-noise-in-estimating-10-mortality-per-center"><i class="fa fa-check"></i>Fig 5.2: Noise in estimating 10% mortality per center</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#figs-5.3-and-5.4"><i class="fa fa-check"></i>Figs 5.3 and 5.4</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#n20"><i class="fa fa-check"></i>n=20</a></li>
<li class="chapter" data-level="" data-path="overfitting.html"><a href="overfitting.html#n200"><i class="fa fa-check"></i>n=200</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="altmods.html"><a href="altmods.html"><i class="fa fa-check"></i><b>6</b> Choosing Between Alternative Models</a>
<ul>
<li class="chapter" data-level="" data-path="altmods.html"><a href="altmods.html#non-linearity-illustrations"><i class="fa fa-check"></i>Non-linearity illustrations</a>
<ul>
<li class="chapter" data-level="" data-path="altmods.html"><a href="altmods.html#prepare-gusto-data"><i class="fa fa-check"></i>Prepare GUSTO data</a></li>
<li class="chapter" data-level="" data-path="altmods.html"><a href="altmods.html#anova-results-for-the-different-fits"><i class="fa fa-check"></i>Anova results for the different fits</a></li>
<li class="chapter" data-level="" data-path="altmods.html"><a href="altmods.html#plotting-of-age-effects"><i class="fa fa-check"></i>Plotting of age effects</a></li>
<li class="chapter" data-level="" data-path="altmods.html"><a href="altmods.html#start-surgical-mortality-by-age-in-medicare"><i class="fa fa-check"></i>Start surgical mortality by age in Medicare</a></li>
<li class="chapter" data-level="" data-path="altmods.html"><a href="altmods.html#anova-results-for-the-fit-of-age-with-interaction-by-type-of-surgery"><i class="fa fa-check"></i>Anova results for the fit of age, with interaction by type of surgery</a></li>
<li class="chapter" data-level="" data-path="altmods.html"><a href="altmods.html#plotting-of-predicted-age-effects-with-interaction-by-type-of-surgery-add-95-ci"><i class="fa fa-check"></i>Plotting of predicted age effects, with interaction by type of surgery; add 95% CI</a></li>
<li class="chapter" data-level="" data-path="altmods.html"><a href="altmods.html#plotting-of-age-effects-with-original-data-points"><i class="fa fa-check"></i>Plotting of age effects with original data points</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Part II: Developing Valid Prediction Models</b></span></li>
<li class="chapter" data-level="7" data-path="missing.html"><a href="missing.html"><i class="fa fa-check"></i><b>7</b> Missing values</a></li>
<li class="chapter" data-level="8" data-path="missing-case.html"><a href="missing-case.html"><i class="fa fa-check"></i><b>8</b> Case Study on Dealing with Missing Values</a></li>
<li class="chapter" data-level="9" data-path="coding.html"><a href="coding.html"><i class="fa fa-check"></i><b>9</b> Coding of Categorical and Continuous Predictors</a>
<ul>
<li class="chapter" data-level="" data-path="coding.html"><a href="coding.html#figues-9.1-to-9.6"><i class="fa fa-check"></i>Figues 9.1 to 9.6</a>
<ul>
<li class="chapter" data-level="" data-path="coding.html"><a href="coding.html#fig-9.1-age-linear-add-square-rcs-in-gusto-i"><i class="fa fa-check"></i>Fig 9.1: Age linear; add square; rcs in GUSTO-I</a></li>
<li class="chapter" data-level="" data-path="coding.html"><a href="coding.html#fig-9.2-impact-of-number-of-st-elevations-ste"><i class="fa fa-check"></i>Fig 9.2: Impact of number of ST elevations (STE)</a></li>
<li class="chapter" data-level="" data-path="coding.html"><a href="coding.html#fig-9.3-non-linearities-in-small-sample-n751-and-full-gusto-i-n40830"><i class="fa fa-check"></i>Fig 9.3: Non-linearities in small sample (n=751); and full GUSTO-I (n=40,830)</a></li>
<li class="chapter" data-level="" data-path="coding.html"><a href="coding.html#fig-9.4-glucose-and-hb-in-tbi"><i class="fa fa-check"></i>Fig 9.4: Glucose and hb in TBI</a></li>
<li class="chapter" data-level="" data-path="coding.html"><a href="coding.html#fig-9.5-non-linear-association-of-glucose"><i class="fa fa-check"></i>Fig 9.5: Non-linear association of glucose</a></li>
<li class="chapter" data-level="" data-path="coding.html"><a href="coding.html#fig-9.6-systolic-blood-pressure-in-tbi"><i class="fa fa-check"></i>Fig 9.6: Systolic blood pressure in TBI</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="restrictions.html"><a href="restrictions.html"><i class="fa fa-check"></i><b>10</b> Restrictions on Candidate Predictors</a>
<ul>
<li class="chapter" data-level="" data-path="restrictions.html"><a href="restrictions.html#case-study"><i class="fa fa-check"></i>Case-study:</a>
<ul>
<li class="chapter" data-level="" data-path="restrictions.html"><a href="restrictions.html#mortality-after-surgery-for-esophageal-cancer"><i class="fa fa-check"></i>Mortality after surgery for esophageal cancer</a></li>
<li class="chapter" data-level="" data-path="restrictions.html"><a href="restrictions.html#testing-the-equal-weights-assumption-in-a-simple-sumscore"><i class="fa fa-check"></i>Testing the equal weights assumption in a simple sumscore</a></li>
<li class="chapter" data-level="" data-path="restrictions.html"><a href="restrictions.html#discussion"><i class="fa fa-check"></i>Discussion</a></li>
<li class="chapter" data-level="" data-path="restrictions.html"><a href="restrictions.html#literature"><i class="fa fa-check"></i>Literature</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="selection.html"><a href="selection.html"><i class="fa fa-check"></i><b>11</b> Selection of Main Effects</a></li>
<li class="chapter" data-level="12" data-path="additivity-linearity.html"><a href="additivity-linearity.html"><i class="fa fa-check"></i><b>12</b> Assumptions in Regression Models - Additivity and Linearity</a>
<ul>
<li class="chapter" data-level="" data-path="additivity-linearity.html"><a href="additivity-linearity.html#gusto-i-interaction-analysis"><i class="fa fa-check"></i>GUSTO-I interaction analysis</a>
<ul>
<li class="chapter" data-level="" data-path="additivity-linearity.html"><a href="additivity-linearity.html#examine-interactions"><i class="fa fa-check"></i>Examine interactions</a></li>
<li class="chapter" data-level="" data-path="additivity-linearity.html"><a href="additivity-linearity.html#fig-12.1"><i class="fa fa-check"></i>Fig 12.1</a></li>
<li class="chapter" data-level="" data-path="additivity-linearity.html"><a href="additivity-linearity.html#fig-12.2"><i class="fa fa-check"></i>Fig 12.2</a></li>
<li class="chapter" data-level="" data-path="additivity-linearity.html"><a href="additivity-linearity.html#smart-coding-illustration"><i class="fa fa-check"></i>Smart coding illustration</a></li>
<li class="chapter" data-level="" data-path="additivity-linearity.html"><a href="additivity-linearity.html#table-12.2-better-predictions"><i class="fa fa-check"></i>Table 12.2 Better predictions?</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="additivity-linearity.html"><a href="additivity-linearity.html#mfp-and-other-non-linear-analyses-in-n544-data"><i class="fa fa-check"></i>MFP and other non-linear analyses in n544 data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>13</b> Modern Estimation Methods</a></li>
<li class="chapter" data-level="14" data-path="estimation-external.html"><a href="estimation-external.html"><i class="fa fa-check"></i><b>14</b> Estimation with External Information</a>
<ul>
<li class="chapter" data-level="" data-path="estimation-external.html"><a href="estimation-external.html#learning-from-external-information"><i class="fa fa-check"></i>Learning from external information</a>
<ul>
<li class="chapter" data-level="14.0.1" data-path="estimation-external.html"><a href="estimation-external.html#a-local-model-with-external-information-table-14.1"><i class="fa fa-check"></i><b>14.0.1</b> A local model with external information: Table 14.1</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimation-external.html"><a href="estimation-external.html#the-data-tbi-n11022-and-aaa-n238-data-sets"><i class="fa fa-check"></i>The data: TBI (n=11022) and AAA (n=238) data sets</a></li>
<li class="chapter" data-level="" data-path="estimation-external.html"><a href="estimation-external.html#the-impact-study"><i class="fa fa-check"></i>The impact study</a>
<ul>
<li class="chapter" data-level="14.0.2" data-path="estimation-external.html"><a href="estimation-external.html#descriptives"><i class="fa fa-check"></i><b>14.0.2</b> Descriptives</a></li>
<li class="chapter" data-level="14.0.3" data-path="estimation-external.html"><a href="estimation-external.html#analyses-for-table-14.2"><i class="fa fa-check"></i><b>14.0.3</b> Analyses for Table 14.2</a></li>
<li class="chapter" data-level="14.0.4" data-path="estimation-external.html"><a href="estimation-external.html#estimation-of-coefficients-naive-stratified-and-ipd-ma"><i class="fa fa-check"></i><b>14.0.4</b> Estimation of coefficients: naive, stratified and IPD-MA</a></li>
<li class="chapter" data-level="14.0.5" data-path="estimation-external.html"><a href="estimation-external.html#estimation-of-standard-errors"><i class="fa fa-check"></i><b>14.0.5</b> Estimation of standard errors</a></li>
<li class="chapter" data-level="14.0.6" data-path="estimation-external.html"><a href="estimation-external.html#estimation-for-a-specific-study-assuming-a-global-model-holds"><i class="fa fa-check"></i><b>14.0.6</b> Estimation for a specific study, assuming a global model holds</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimation-external.html"><a href="estimation-external.html#the-aaa-study"><i class="fa fa-check"></i>The AAA study</a>
<ul>
<li class="chapter" data-level="14.0.7" data-path="estimation-external.html"><a href="estimation-external.html#descriptives-1"><i class="fa fa-check"></i><b>14.0.7</b> Descriptives</a></li>
<li class="chapter" data-level="14.0.8" data-path="estimation-external.html"><a href="estimation-external.html#literature-univariate-estimates-table-14.4"><i class="fa fa-check"></i><b>14.0.8</b> Literature, univariate estimates: Table 14.4</a></li>
<li class="chapter" data-level="14.0.9" data-path="estimation-external.html"><a href="estimation-external.html#a-simple-prediction-model-table-14.5"><i class="fa fa-check"></i><b>14.0.9</b> A simple prediction model: Table 14.5</a></li>
<li class="chapter" data-level="14.0.10" data-path="estimation-external.html"><a href="estimation-external.html#adaptation-of-univariate-coefficients-table-14.6"><i class="fa fa-check"></i><b>14.0.10</b> Adaptation of univariate coefficients: Table 14.6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="estimation-external.html"><a href="estimation-external.html#conclusions"><i class="fa fa-check"></i>Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="evaluation.html"><a href="evaluation.html"><i class="fa fa-check"></i><b>15</b> Evaluation of Performance</a></li>
<li class="chapter" data-level="16" data-path="usefulness.html"><a href="usefulness.html"><i class="fa fa-check"></i><b>16</b> Evaluation of Clinical Usefulness</a></li>
<li class="chapter" data-level="17" data-path="validation.html"><a href="validation.html"><i class="fa fa-check"></i><b>17</b> Validation of Prediction Models</a></li>
<li class="chapter" data-level="18" data-path="presentation.html"><a href="presentation.html"><i class="fa fa-check"></i><b>18</b> Presentation Formats</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#fit-logistic-models-in-n544-data-set-6-predictors"><i class="fa fa-check"></i>Fit logistic models in n544 data set; 6 predictors</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#internal-validation-by-bootstrapping"><i class="fa fa-check"></i>Internal validation by bootstrapping</a></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#shrunk-model-and-penalization"><i class="fa fa-check"></i>Shrunk model and penalization</a></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#fit-penalized-model-and-compare-fits"><i class="fa fa-check"></i>Fit penalized model and compare fits</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#fig-18.1"><i class="fa fa-check"></i>Fig 18.1</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#make-nomogram-from-penalized-model"><i class="fa fa-check"></i>Make nomogram from penalized model</a></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#score-chart-creation-with-categorized-and-continuous-predictors"><i class="fa fa-check"></i>Score chart creation with categorized and continuous predictors</a></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#consider-making-rounded-scores-from-penalized-coefs"><i class="fa fa-check"></i>Consider making rounded scores from penalized coefs</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#scores-for-continuous-predictors"><i class="fa fa-check"></i>Scores for continuous predictors</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#ldh"><i class="fa fa-check"></i>LDH</a></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#study-scores-for-postchemotherapy-size"><i class="fa fa-check"></i>Study scores for postchemotherapy size</a></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#study-scores-for-reduction-in-size"><i class="fa fa-check"></i>Study scores for reduction in size</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#table-18.2"><i class="fa fa-check"></i>Table 18.2</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#make-a-score-chart"><i class="fa fa-check"></i>Make a score chart</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#fig-18.2"><i class="fa fa-check"></i>Fig 18.2</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#translate-score-in-probability-estimates-with-95-ci"><i class="fa fa-check"></i>Translate score in probability estimates with 95% CI</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#end-table-18.2-score-chart-and-fig-18.2-graphic-translation-from-score-to-probability"><i class="fa fa-check"></i>End Table 18.2 (score chart) and Fig 18.2 (graphic translation from score to probability)</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#categorized-coding"><i class="fa fa-check"></i>Categorized coding</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#table-18.3"><i class="fa fa-check"></i>Table 18.3</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#alternative-make-a-score-from-0---5"><i class="fa fa-check"></i>Alternative: make a score from 0 - 5</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#fig-18.3"><i class="fa fa-check"></i>Fig 18.3</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#iso-probability-lines"><i class="fa fa-check"></i>Iso-probability lines</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#fig-18.4"><i class="fa fa-check"></i>Fig 18.4</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#meta-model-with-tree-presentation"><i class="fa fa-check"></i>Meta-model with tree presentation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#apparent-performance-of-penalized-vs-rescaled-vs-simplified-models"><i class="fa fa-check"></i>Apparent performance of penalized vs rescaled vs simplified models</a>
<ul>
<li class="chapter" data-level="" data-path="presentation.html"><a href="presentation.html#end-comparisons-of-c-statistics"><i class="fa fa-check"></i>End comparisons of c statistics</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Part III: Generalizability of Prediction Models</b></span></li>
<li class="chapter" data-level="19" data-path="external-validity.html"><a href="external-validity.html"><i class="fa fa-check"></i><b>19</b> Patterns of External Validity</a>
<ul>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.1-a-missed-predictor-z"><i class="fa fa-check"></i>Fig 19.1: a missed predictor Z</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.2-a-missed-predictor-z-with-identical-distribution"><i class="fa fa-check"></i>Fig 19.2: a missed predictor Z with identical distribution</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.3-more-or-less-severe-cases-selected"><i class="fa fa-check"></i>Fig 19.3: more or less severe cases selected</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.4-more-or-less-heterogeneous-cases-selected"><i class="fa fa-check"></i>Fig 19.4: more or less heterogeneous cases selected</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.5-more-or-less-severe-cases-selected-by-z"><i class="fa fa-check"></i>Fig 19.5: more or less severe cases selected by Z</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.6-more-or-less-heterogeneous-cases-selected-by-z"><i class="fa fa-check"></i>Fig 19.6: more or less heterogeneous cases selected by Z</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.7-case-control-design-disturbs-calibration"><i class="fa fa-check"></i>Fig 19.7: Case-control design disturbs calibration</a>
<ul>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.8-overfitting-disturbs-discrimination-and-calibration"><i class="fa fa-check"></i>Fig 19.8: Overfitting disturbs discrimination and calibration</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#fig-19.9-different-coeficients-model-misspecification-disturbs-discrimination-and-calibration"><i class="fa fa-check"></i>Fig 19.9: Different coeficients (model misspecification) disturbs discrimination and calibration</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#scenarios-table-19.4"><i class="fa fa-check"></i>Scenarios: Table 19.4</a></li>
<li class="chapter" data-level="" data-path="external-validity.html"><a href="external-validity.html#uncertainty-in-validation-simulations"><i class="fa fa-check"></i>Uncertainty in validation simulations</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="updating.html"><a href="updating.html"><i class="fa fa-check"></i><b>20</b> Updating for a New Setting</a></li>
<li class="chapter" data-level="21" data-path="updating-multiple.html"><a href="updating-multiple.html"><i class="fa fa-check"></i><b>21</b> Updating for Multiple Settings</a></li>
<li class="part"><span><b>IV Part IIII: Applications</b></span></li>
<li class="chapter" data-level="22" data-path="case-study-gusto.html"><a href="case-study-gusto.html"><i class="fa fa-check"></i><b>22</b> Case Study on a Prediction of 30-Day Mortality</a></li>
<li class="chapter" data-level="23" data-path="case-study-cardiovascular.html"><a href="case-study-cardiovascular.html"><i class="fa fa-check"></i><b>23</b> Case Study on Survival Analysis: Prediction of Cardiovascular Event</a></li>
<li class="chapter" data-level="24" data-path="lessons-datasets.html"><a href="lessons-datasets.html"><i class="fa fa-check"></i><b>24</b> Overall Lessons and Data Sets</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Clinical prediction models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="estimation-external" class="section level1 hasAnchor" number="14">
<h1><span class="header-section-number">14</span> Estimation with External Information<a href="estimation-external.html#estimation-external" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="learning-from-external-information" class="section level2 unnumbered hasAnchor">
<h2>Learning from external information<a href="estimation-external.html#learning-from-external-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="a-local-model-with-external-information-table-14.1" class="section level3 hasAnchor" number="14.0.1">
<h3><span class="header-section-number">14.0.1</span> A local model with external information: Table 14.1<a href="estimation-external.html#a-local-model-with-external-information-table-14.1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use external information to optimize the development of a prediction model with local or global applicability.</p>
<p>Table 14.1 provides the basic idea of model development with a focus on a locally applicable model.</p>
<table>
<caption>
(#tab:Table14.1)Table 14.1: local vs global models
</caption>
<thead>
<tr>
<th style="text-align:left;">
Modeling aspect
</th>
<th style="text-align:left;">
Local model
</th>
<th style="text-align:left;">
Global model
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Model specification
</td>
<td style="text-align:left;">
Mixture of IPD and literature
</td>
<td style="text-align:left;">
Focus on consensus in literature
</td>
</tr>
<tr>
<td style="text-align:left;">
Model coefficients
</td>
<td style="text-align:left;">
IPD with literature as background
</td>
<td style="text-align:left;">
Meta-analysis of literature
</td>
</tr>
<tr>
<td style="text-align:left;">
Baseline risk
</td>
<td style="text-align:left;">
IPD
</td>
<td style="text-align:left;">
Literature
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="the-data-tbi-n11022-and-aaa-n238-data-sets" class="section level2 unnumbered hasAnchor">
<h2>The data: TBI (n=11022) and AAA (n=238) data sets<a href="estimation-external.html#the-data-tbi-n11022-and-aaa-n238-data-sets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The impact data set includes patients with moderate / severe TBI for 15 studies (<a href="https://pubmed.ncbi.nlm.nih.gov/31373722/" title="Assessment of heterogeneity in an individual participant data meta-analysis of prediction models: An overview and illustration">Steyerberg 2019</a>). We can learn from the combined information in an Individual Patient Data Meta-Analysis (IPD MA).</p>
<p>The AAA data set includes a small set of patients undergoing elective surgery for Abdominal Aortic Aneurysm (<a href="https://pubmed.ncbi.nlm.nih.gov/7575054/" title="Perioperative mortality of elective abdominal aortic aneurysm surgery. A clinical prediction rule based on literature and individual patient data">Steyerberg 1995</a>). We can learn from univariate information in the literature where many studies are available (<a href="https://pubmed.ncbi.nlm.nih.gov/22883206/" title="Incorporating published univariable associations in diagnostic and prognostic modeling">Debray 2012</a>). Specifically, we borrow information from the univariate coefficients in other studies and perform an adaptation of the multivariable coefficients in the AAA data set. The resulting model is stabilized such that better local and global performance is expected.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="estimation-external.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># impact data come with metamisc package Debray; read here</span></span>
<span id="cb60-2"><a href="estimation-external.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;impact&quot;</span>, <span class="at">package =</span> <span class="st">&quot;metamisc&quot;</span>)</span>
<span id="cb60-3"><a href="estimation-external.html#cb60-3" aria-hidden="true" tabindex="-1"></a>impact<span class="sc">$</span>name         <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(impact<span class="sc">$</span>name)</span>
<span id="cb60-4"><a href="estimation-external.html#cb60-4" aria-hidden="true" tabindex="-1"></a>impact<span class="sc">$</span>ct           <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(impact<span class="sc">$</span>ct)</span>
<span id="cb60-5"><a href="estimation-external.html#cb60-5" aria-hidden="true" tabindex="-1"></a>impact<span class="sc">$</span>age10        <span class="ot">&lt;-</span> impact<span class="sc">$</span>age<span class="sc">/</span><span class="dv">10</span> <span class="sc">-</span> <span class="fl">3.5</span> <span class="co"># reference 35-year-old patient, close to mean age</span></span>
<span id="cb60-6"><a href="estimation-external.html#cb60-6" aria-hidden="true" tabindex="-1"></a>impact<span class="sc">$</span>motor_score  <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(impact<span class="sc">$</span>motor_score)</span>
<span id="cb60-7"><a href="estimation-external.html#cb60-7" aria-hidden="true" tabindex="-1"></a>impact<span class="sc">$</span>pupil        <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(impact<span class="sc">$</span>pupil)</span>
<span id="cb60-8"><a href="estimation-external.html#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(impact<span class="sc">$</span>ct) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;I/II&quot;</span>, <span class="st">&quot;III/IV&quot;</span>, <span class="st">&quot;V/VI&quot;</span>) <span class="co"># correct an error in Debray labels</span></span>
<span id="cb60-9"><a href="estimation-external.html#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="estimation-external.html#cb60-10" aria-hidden="true" tabindex="-1"></a>impact<span class="sc">$</span>motor.lin    <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(impact<span class="sc">$</span>motor_score) <span class="co"># 1/2, 3, 4, 5/6 linear</span></span>
<span id="cb60-11"><a href="estimation-external.html#cb60-11" aria-hidden="true" tabindex="-1"></a>impact<span class="sc">$</span>pupil.lin    <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(impact<span class="sc">$</span>pupil) <span class="co"># 1, 2, 3 linear</span></span>
<span id="cb60-12"><a href="estimation-external.html#cb60-12" aria-hidden="true" tabindex="-1"></a>impact<span class="sc">$</span>study <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;TINT&quot;</span>, <span class="dv">1</span>,</span>
<span id="cb60-13"><a href="estimation-external.html#cb60-13" aria-hidden="true" tabindex="-1"></a>                <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;TIUS&quot;</span>, <span class="dv">2</span>,</span>
<span id="cb60-14"><a href="estimation-external.html#cb60-14" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;SLIN&quot;</span>, <span class="dv">3</span>,</span>
<span id="cb60-15"><a href="estimation-external.html#cb60-15" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;SAP&quot;</span>, <span class="dv">4</span>,</span>
<span id="cb60-16"><a href="estimation-external.html#cb60-16" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;PEG&quot;</span>, <span class="dv">5</span>,</span>
<span id="cb60-17"><a href="estimation-external.html#cb60-17" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;HIT I&quot;</span>, <span class="dv">6</span>,</span>
<span id="cb60-18"><a href="estimation-external.html#cb60-18" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;UK4&quot;</span>, <span class="dv">7</span>,</span>
<span id="cb60-19"><a href="estimation-external.html#cb60-19" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;TCDB&quot;</span>, <span class="dv">8</span>,</span>
<span id="cb60-20"><a href="estimation-external.html#cb60-20" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;SKB&quot;</span>, <span class="dv">9</span>,</span>
<span id="cb60-21"><a href="estimation-external.html#cb60-21" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;EBIC&quot;</span>, <span class="dv">10</span>,</span>
<span id="cb60-22"><a href="estimation-external.html#cb60-22" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;HIT II&quot;</span>, <span class="dv">11</span>,</span>
<span id="cb60-23"><a href="estimation-external.html#cb60-23" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;NABIS&quot;</span>, <span class="dv">12</span>,</span>
<span id="cb60-24"><a href="estimation-external.html#cb60-24" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;CSTAT&quot;</span>, <span class="dv">13</span>,</span>
<span id="cb60-25"><a href="estimation-external.html#cb60-25" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;PHARMOS&quot;</span>, <span class="dv">14</span>,</span>
<span id="cb60-26"><a href="estimation-external.html#cb60-26" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(impact<span class="sc">$</span>name<span class="sc">==</span><span class="st">&quot;APOE&quot;</span>, <span class="dv">15</span>,<span class="cn">NA</span>))))))))))))))))</span>
<span id="cb60-27"><a href="estimation-external.html#cb60-27" aria-hidden="true" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">levels</span>(impact[,<span class="dv">1</span>])</span>
<span id="cb60-28"><a href="estimation-external.html#cb60-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-29"><a href="estimation-external.html#cb60-29" aria-hidden="true" tabindex="-1"></a>AAA  <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/AAA.csv&quot;</span>, <span class="at">row.names =</span> <span class="dv">1</span>)</span></code></pre></div>
</details>
</div>
<div id="the-impact-study" class="section level2 unnumbered hasAnchor">
<h2>The impact study<a href="estimation-external.html#the-impact-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="descriptives" class="section level3 hasAnchor" number="14.0.2">
<h3><span class="header-section-number">14.0.2</span> Descriptives<a href="estimation-external.html#descriptives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Overall results are presented below. We note that missing values were imputed (using mice, a single imputation for simple illustrations).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="estimation-external.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span>(<span class="fu">describe</span>(impact), <span class="at">scroll=</span><span class="cn">TRUE</span>) </span></code></pre></div>
</details>
<div style="width: 100ex; overflow: auto; height: 25ex;"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<script type="text/javascript">
<!--
    function expand_collapse(id) {
       var e = document.getElementById(id);
       var f = document.getElementById(id+"_earrows");
       if(e.style.display == 'none'){
          e.style.display = 'block';
          f.innerHTML = '&#9650';
       }
       else {
          e.style.display = 'none';
          f.innerHTML = '&#9660';
       }
    }
//-->
</script>
<style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: &#808080;
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>
 <title>impact Descriptives</title> <font color="MidnightBlue"><div align=center><span style="font-weight:bold">impact <br><br> 15  Variables   11022  Observations</span></div></font> <hr class="thinhr"> <span style="font-weight:bold">name</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAC4AAAANCAMAAADhX6ydAAAACVBMVEUAAADMzMz////1iUV5AAAAT0lEQVQokbWQUQoAIAhDZ/c/dNjILIX8UYbYfBoICQFEz3ojBBLPeh24WWWcLjxiWQs/dXDe4cla+APRWsJvO99b8F/V8UfXbAueCZIqdyfiIAK5Me79nQAAAABJRU5ErkJggg==" alt="image" /></div> <style>
 .hmisctable657861 {
 border: none;
 font-size: 85%;
 }
 .hmisctable657861 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable657861 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable657861">
 <tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>11022</td><td>0</td><td>15</td></tr>
 </table>
 <span style="font-size: 85%;"><font color="MidnightBlue">lowest</font> : APOE   CSTAT  EBIC   HIT I  HIT II ,  <font color="MidnightBlue">highest</font>: SLIN   TCDB   TINT   TIUS   UK4   </span> <pre style="font-size:85%;">
 Value         APOE   CSTAT    EBIC   HIT I  HIT II   NABIS     PEG PHARMOS     SAP
 Frequency      756     517     822     350     819     385    1510     856     919
 Proportion   0.069   0.047   0.075   0.032   0.074   0.035   0.137   0.078   0.083
                                                           
 Value          SKB    SLIN    TCDB    TINT    TIUS     UK4
 Frequency      126     409     603    1118    1041     791
 Proportion   0.011   0.037   0.055   0.101   0.094   0.072
 </pre>
 <hr class="thinhr"> <span style="font-weight:bold">type</span> <style>
 .hmisctable328706 {
 border: none;
 font-size: 85%;
 }
 .hmisctable328706 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable328706 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable328706">
 <tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>11022</td><td>0</td><td>2</td></tr>
 </table>
 <pre style="font-size:85%;">
 Value       OBS  RCT
 Frequency  2972 8050
 Proportion 0.27 0.73
 </pre>
 <hr class="thinhr"> <span style="font-weight:bold">age</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAbUlEQVQ4jc3TUQrAIAwD0MT7H3qbcwVHdaxU2whF/PERKCgBwDRBkeBOSRFhAMld1RbO013xtbX/36pwWVtBzXWt5zO2b+qkL62/bS3+cI21q1x2VafzZDq5vsgW11KVFYjRLvqH56mju6hv5AFLoAmXsSf0pQAAAABJRU5ErkJggg==" alt="image" /></div> <style>
 .hmisctable209497 {
 border: none;
 font-size: 85%;
 }
 .hmisctable209497 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable209497 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable209497">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th><th>.05</th><th>.10</th><th>.25</th><th>.50</th><th>.75</th><th>.90</th><th>.95</th></tr>
 <tr><td>11022</td><td>0</td><td>80</td><td>0.999</td><td>34.93</td><td>17.58</td><td>17</td><td>18</td><td>22</td><td>31</td><td>46</td><td>59</td><td>65</td></tr>
 </table>
 <span style="font-size: 85%;"><font color="MidnightBlue">lowest</font> : 14 15 16 17 18 ,  <font color="MidnightBlue">highest</font>: 89 90 91 92 93</span> <hr class="thinhr"> <span style="font-weight:bold">motor_score</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAMAAABFNRROAAAACVBMVEUAAADMzMz////1iUV5AAAAJklEQVQImWNgRAAGBgYmBGBA4SJ4IBrCQ2B0HsgsGMavkngespkAQpAApng6CAMAAAAASUVORK5CYII=" alt="image" /></div> <style>
 .hmisctable621346 {
 border: none;
 font-size: 85%;
 }
 .hmisctable621346 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable621346 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable621346">
 <tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>11022</td><td>0</td><td>4</td></tr>
 </table>
 <pre style="font-size:85%;">
 Value        1/2     3     4   5/6
 Frequency   2850  2285  2438  3449
 Proportion 0.259 0.207 0.221 0.313
 </pre>
 <hr class="thinhr"> <span style="font-weight:bold">pupil</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAoAAAANCAMAAACn6Q83AAAACVBMVEUAAADMzMz////1iUV5AAAAIUlEQVQImWNgYIQBBgYmGCCNicsEKBcbk4EBhQnSCtYPADc4ALRqtyaiAAAAAElFTkSuQmCC" alt="image" /></div> <style>
 .hmisctable190644 {
 border: none;
 font-size: 85%;
 }
 .hmisctable190644 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable190644 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable190644">
 <tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>11022</td><td>0</td><td>3</td></tr>
 </table>
 <pre style="font-size:85%;">
 Value       Both  None   One
 Frequency   7325  2296  1401
 Proportion 0.665 0.208 0.127
 </pre>
 <hr class="thinhr"> <span style="font-weight:bold">ct</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAoAAAANCAMAAACn6Q83AAAACVBMVEUAAADMzMz////1iUV5AAAAHklEQVQImWNgYIQABiBgggBSmSDNcBPAMqQy4SYAACojAIpx1DUiAAAAAElFTkSuQmCC" alt="image" /></div> <style>
 .hmisctable662852 {
 border: none;
 font-size: 85%;
 }
 .hmisctable662852 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable662852 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable662852">
 <tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>11022</td><td>0</td><td>3</td></tr>
 </table>
 <pre style="font-size:85%;">
 Value        I/II III/IV   V/VI
 Frequency    4479   2239   4304
 Proportion  0.406  0.203  0.390
 </pre>
 <hr class="thinhr"> <span style="font-weight:bold">hypox</span> <style>
 .hmisctable309158 {
 border: none;
 font-size: 85%;
 }
 .hmisctable309158 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable309158 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable309158">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>11022</td><td>0</td><td>2</td><td>0.507</td><td>2375</td><td>0.2155</td><td>0.3381</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">hypots</span> <style>
 .hmisctable325310 {
 border: none;
 font-size: 85%;
 }
 .hmisctable325310 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable325310 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable325310">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>11022</td><td>0</td><td>2</td><td>0.424</td><td>1875</td><td>0.1701</td><td>0.2824</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">tsah</span> <style>
 .hmisctable717981 {
 border: none;
 font-size: 85%;
 }
 .hmisctable717981 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable717981 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable717981">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>11022</td><td>0</td><td>2</td><td>0.744</td><td>5012</td><td>0.4547</td><td>0.4959</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">edh</span> <style>
 .hmisctable684423 {
 border: none;
 font-size: 85%;
 }
 .hmisctable684423 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable684423 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable684423">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>11022</td><td>0</td><td>2</td><td>0.346</td><td>1464</td><td>0.1328</td><td>0.2304</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">mort</span> <style>
 .hmisctable293231 {
 border: none;
 font-size: 85%;
 }
 .hmisctable293231 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable293231 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable293231">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>11022</td><td>0</td><td>2</td><td>0.578</td><td>2874</td><td>0.2608</td><td>0.3856</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">age10</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAJcAAAANCAMAAACTvAxuAAAACVBMVEUAAADMzMz////1iUV5AAAAbUlEQVQ4jc3TUQrAIAwD0MT7H3qbcwVHdaxU2whF/PERKCgBwDRBkeBOSRFhAMld1RbO013xtbX/36pwWVtBzXWt5zO2b+qkL62/bS3+cI21q1x2VafzZDq5vsgW11KVFYjRLvqH56mju6hv5AFLoAmXsSf0pQAAAABJRU5ErkJggg==" alt="image" /></div> <style>
 .hmisctable159446 {
 border: none;
 font-size: 85%;
 }
 .hmisctable159446 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable159446 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable159446">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th><th>.05</th><th>.10</th><th>.25</th><th>.50</th><th>.75</th><th>.90</th><th>.95</th></tr>
 <tr><td>11022</td><td>0</td><td>80</td><td>0.999</td><td>-0.006959</td><td>1.758</td><td>-1.8</td><td>-1.7</td><td>-1.3</td><td>-0.4</td><td> 1.1</td><td> 2.4</td><td> 3.0</td></tr>
 </table>
 <span style="font-size: 85%;"><font color="MidnightBlue">lowest</font> : -2.1 -2.0 -1.9 -1.8 -1.7 ,  <font color="MidnightBlue">highest</font>:  5.4  5.5  5.6  5.7  5.8</span> <hr class="thinhr"> <span style="font-weight:bold">motor.lin</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAMAAABFNRROAAAACVBMVEUAAADMzMz////1iUV5AAAAJklEQVQImWNgRAAGBgYmBGBA4SJ4IBrCQ2B0HsgsGMavkngespkAQpAApng6CAMAAAAASUVORK5CYII=" alt="image" /></div> <style>
 .hmisctable321651 {
 border: none;
 font-size: 85%;
 }
 .hmisctable321651 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable321651 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable321651">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>11022</td><td>0</td><td>4</td><td>0.932</td><td>2.588</td><td>1.311</td></tr>
 </table>
 <pre style="font-size:85%;">
 Value          1     2     3     4
 Frequency   2850  2285  2438  3449
 Proportion 0.259 0.207 0.221 0.313
 </pre>
 <hr class="thinhr"> <span style="font-weight:bold">pupil.lin</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAAoAAAANCAMAAACn6Q83AAAACVBMVEUAAADMzMz////1iUV5AAAAIUlEQVQImWNgYIQBBgYmGCCNicsEKBcbk4EBhQnSCtYPADc4ALRqtyaiAAAAAElFTkSuQmCC" alt="image" /></div> <style>
 .hmisctable528110 {
 border: none;
 font-size: 85%;
 }
 .hmisctable528110 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable528110 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable528110">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>11022</td><td>0</td><td>3</td><td>0.695</td><td>1.463</td><td>0.6678</td></tr>
 </table>
 <pre style="font-size:85%;">
 Value          1     2     3
 Frequency   7325  2296  1401
 Proportion 0.665 0.208 0.127
 </pre>
 <hr class="thinhr"> <span style="font-weight:bold">study</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAC4AAAANCAMAAADhX6ydAAAACVBMVEUAAADMzMz////1iUV5AAAAUUlEQVQoka2QSQ4AIAgDi/9/tEZFKmLUxKYHlqEHICRADkIiYeoiveKM3OGDesH5zs5dVMH7Q7iwT42m1UG6Zbr06htcWcVXO+o3vllAQsfTDN7sArkaM43RAAAAAElFTkSuQmCC" alt="image" /></div> <style>
 .hmisctable649277 {
 border: none;
 font-size: 85%;
 }
 .hmisctable649277 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable649277 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable649277">
 <tr><th>n</th><th>missing</th><th>distinct</th></tr>
 <tr><td>11022</td><td>0</td><td>15</td></tr>
 </table>
 <span style="font-size: 85%;"><font color="MidnightBlue">lowest</font> : 1  2  3  4  5  ,  <font color="MidnightBlue">highest</font>: 11 12 13 14 15</span> <pre style="font-size:85%;">
 Value          1     2     3     4     5     6     7     8     9    10    11    12
 Frequency   1118  1041   409   919  1510   350   791   603   126   822   819   385
 Proportion 0.101 0.094 0.037 0.083 0.137 0.032 0.072 0.055 0.011 0.075 0.074 0.035
                             
 Value         13    14    15
 Frequency    517   856   756
 Proportion 0.047 0.078 0.069
 </pre>
 <hr class="thinhr"> </div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="estimation-external.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">table</span>(impact<span class="sc">$</span>name, impact<span class="sc">$</span>mort), <span class="at">row.names =</span> T, <span class="at">caption =</span> <span class="st">&quot;Mortality by study&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:impact.data.describe)Mortality by study
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
APOE
</td>
<td style="text-align:right;">
639
</td>
<td style="text-align:right;">
117
</td>
</tr>
<tr>
<td style="text-align:left;">
CSTAT
</td>
<td style="text-align:right;">
402
</td>
<td style="text-align:right;">
115
</td>
</tr>
<tr>
<td style="text-align:left;">
EBIC
</td>
<td style="text-align:right;">
541
</td>
<td style="text-align:right;">
281
</td>
</tr>
<tr>
<td style="text-align:left;">
HIT I
</td>
<td style="text-align:right;">
251
</td>
<td style="text-align:right;">
99
</td>
</tr>
<tr>
<td style="text-align:left;">
HIT II
</td>
<td style="text-align:right;">
631
</td>
<td style="text-align:right;">
188
</td>
</tr>
<tr>
<td style="text-align:left;">
NABIS
</td>
<td style="text-align:right;">
284
</td>
<td style="text-align:right;">
101
</td>
</tr>
<tr>
<td style="text-align:left;">
PEG
</td>
<td style="text-align:right;">
1148
</td>
<td style="text-align:right;">
362
</td>
</tr>
<tr>
<td style="text-align:left;">
PHARMOS
</td>
<td style="text-align:right;">
711
</td>
<td style="text-align:right;">
145
</td>
</tr>
<tr>
<td style="text-align:left;">
SAP
</td>
<td style="text-align:right;">
707
</td>
<td style="text-align:right;">
212
</td>
</tr>
<tr>
<td style="text-align:left;">
SKB
</td>
<td style="text-align:right;">
92
</td>
<td style="text-align:right;">
34
</td>
</tr>
<tr>
<td style="text-align:left;">
SLIN
</td>
<td style="text-align:right;">
315
</td>
<td style="text-align:right;">
94
</td>
</tr>
<tr>
<td style="text-align:left;">
TCDB
</td>
<td style="text-align:right;">
339
</td>
<td style="text-align:right;">
264
</td>
</tr>
<tr>
<td style="text-align:left;">
TINT
</td>
<td style="text-align:right;">
840
</td>
<td style="text-align:right;">
278
</td>
</tr>
<tr>
<td style="text-align:left;">
TIUS
</td>
<td style="text-align:right;">
816
</td>
<td style="text-align:right;">
225
</td>
</tr>
<tr>
<td style="text-align:left;">
UK4
</td>
<td style="text-align:right;">
432
</td>
<td style="text-align:right;">
359
</td>
</tr>
</tbody>
</table>
</div>
<div id="analyses-for-table-14.2" class="section level3 hasAnchor" number="14.0.3">
<h3><span class="header-section-number">14.0.3</span> Analyses for Table 14.2<a href="estimation-external.html#analyses-for-table-14.2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We analyze various model variants for the <code>impact</code> data, with 3 key predictors:</p>
<ul>
<li><p><code>age10</code>: age per decade, continuous; centered at age 40</p></li>
<li><p><code>motor.lin</code>: the Motor score component from the Glasgow Coma Scale, continuous for codes 1/2, 3, 4, 5/6</p></li>
<li><p><code>pupil.lin</code>: pupillary reactivity, continuous for codes 1, 2, 3 relating to both, one, or no reacting pupils</p></li>
</ul>
<p>The models are as follows:</p>
<ol style="list-style-type: decimal">
<li>A naive analyses of the merged data, ignoring the clustering nature of the data (<code>rms::lrm</code>)</li>
<li>Per study analyses for each of the 15 studies (<code>rms::lrm</code>)</li>
<li>Stratified analysis, with study as a factor variable to estimate common predictor effects (<code>rms::lrm</code>)</li>
<li>One-stage meta-analysis, with study as a random effect to estimate common predictor effects (<code>lme4::glmer</code>)</li>
<li>Two-stage univariate meta-analysis, with pooling of the per study estimates obtained in step 2, to obtain random effect estimates for the predictor effects (<code>metamisc::uvmeta</code>)</li>
</ol>
<p>The output includes estimates for the model intercept and the predictor effects. Standard errors (SE) are obtained for each estimate. Moreover, the 1-step and 2-step meta-analyses estimate the heterogeneity parameter tau, which reflects between study differences in the estimates. This heterogeneity is considered in the random effect 95% confidence intervals, and in 95% prediction intervals.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="estimation-external.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># store the results in 2 matrices to produce something close to Table 14.2</span></span>
<span id="cb63-2"><a href="estimation-external.html#cb63-2" aria-hidden="true" tabindex="-1"></a>coef.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">23</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb63-3"><a href="estimation-external.html#cb63-3" aria-hidden="true" tabindex="-1"></a>se.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">23</span>, <span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb63-4"><a href="estimation-external.html#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(coef.matrix) <span class="ot">&lt;-</span> <span class="fu">dimnames</span>(se.matrix) <span class="ot">&lt;-</span> </span>
<span id="cb63-5"><a href="estimation-external.html#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="fu">c</span>(<span class="fu">levels</span>(impact<span class="sc">$</span>study), <span class="st">&quot;naive&quot;</span>,</span>
<span id="cb63-6"><a href="estimation-external.html#cb63-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;stratified&quot;</span>, <span class="st">&quot;one-stage&quot;</span>, <span class="st">&quot;tau-1&quot;</span>, <span class="st">&quot;two-stage&quot;</span>, <span class="st">&quot;tau-2&quot;</span>, <span class="st">&quot;Low pred&quot;</span>, <span class="st">&quot;High pred&quot;</span>)</span>
<span id="cb63-7"><a href="estimation-external.html#cb63-7" aria-hidden="true" tabindex="-1"></a>                      ,<span class="fu">Cs</span>(Intercept,age,motor,pupils))</span>
<span id="cb63-8"><a href="estimation-external.html#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="estimation-external.html#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="co"># naive merged model</span></span>
<span id="cb63-10"><a href="estimation-external.html#cb63-10" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">lrm</span>(mort<span class="sc">~</span>age10<span class="sc">+</span>motor.lin<span class="sc">+</span>pupil.lin, <span class="at">data=</span>impact)</span>
<span id="cb63-11"><a href="estimation-external.html#cb63-11" aria-hidden="true" tabindex="-1"></a>coef.matrix[<span class="dv">16</span>,] <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit0)  </span>
<span id="cb63-12"><a href="estimation-external.html#cb63-12" aria-hidden="true" tabindex="-1"></a>se.matrix[<span class="dv">16</span>,] <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">se</span>(fit0))</span>
<span id="cb63-13"><a href="estimation-external.html#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="estimation-external.html#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) {</span>
<span id="cb63-15"><a href="estimation-external.html#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="co"># fit stratified models</span></span>
<span id="cb63-16"><a href="estimation-external.html#cb63-16" aria-hidden="true" tabindex="-1"></a>fit.lin <span class="ot">&lt;-</span><span class="fu">lrm</span>(mort<span class="sc">~</span>age10<span class="sc">+</span>motor.lin<span class="sc">+</span>pupil.lin, <span class="at">data=</span>impact, <span class="at">subset=</span>impact<span class="sc">$</span>study<span class="sc">==</span>i)</span>
<span id="cb63-17"><a href="estimation-external.html#cb63-17" aria-hidden="true" tabindex="-1"></a>coef.matrix[i,] <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit.lin)  </span>
<span id="cb63-18"><a href="estimation-external.html#cb63-18" aria-hidden="true" tabindex="-1"></a>se.matrix[i,] <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">se</span>(fit.lin)) }</span>
<span id="cb63-19"><a href="estimation-external.html#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-20"><a href="estimation-external.html#cb63-20" aria-hidden="true" tabindex="-1"></a><span class="co"># global model with stratification; intercept is for Study==1</span></span>
<span id="cb63-21"><a href="estimation-external.html#cb63-21" aria-hidden="true" tabindex="-1"></a>fit.stratified <span class="ot">&lt;-</span> <span class="fu">lrm</span>(mort<span class="sc">~</span>age10<span class="sc">+</span>motor.lin<span class="sc">+</span>pupil.lin <span class="sc">+</span>name, <span class="at">data=</span>impact)</span>
<span id="cb63-22"><a href="estimation-external.html#cb63-22" aria-hidden="true" tabindex="-1"></a>coef.matrix[<span class="dv">17</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit.stratified)[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]  </span>
<span id="cb63-23"><a href="estimation-external.html#cb63-23" aria-hidden="true" tabindex="-1"></a>se.matrix[<span class="dv">17</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">se</span>(fit.stratified))[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] </span>
<span id="cb63-24"><a href="estimation-external.html#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="estimation-external.html#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate heterogeneity in 1 step, global model for covariate effects</span></span>
<span id="cb63-26"><a href="estimation-external.html#cb63-26" aria-hidden="true" tabindex="-1"></a>fit.lin.meta <span class="ot">&lt;-</span> <span class="fu">glmer</span>(mort<span class="sc">~</span> (<span class="dv">1</span> <span class="sc">|</span> name) <span class="sc">+</span> age10  <span class="sc">+</span> motor.lin<span class="sc">+</span>pupil.lin, </span>
<span id="cb63-27"><a href="estimation-external.html#cb63-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span><span class="fu">binomial</span>(), <span class="at">data =</span> impact)</span>
<span id="cb63-28"><a href="estimation-external.html#cb63-28" aria-hidden="true" tabindex="-1"></a>coef.matrix[<span class="dv">18</span>,]  <span class="ot">&lt;-</span> fit.lin.meta<span class="sc">@</span>beta</span>
<span id="cb63-29"><a href="estimation-external.html#cb63-29" aria-hidden="true" tabindex="-1"></a>se.matrix[<span class="dv">18</span>,]    <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(fit.lin.meta)))</span>
<span id="cb63-30"><a href="estimation-external.html#cb63-30" aria-hidden="true" tabindex="-1"></a>coef.matrix[<span class="dv">19</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> fit.lin.meta<span class="sc">@</span>theta</span>
<span id="cb63-31"><a href="estimation-external.html#cb63-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-32"><a href="estimation-external.html#cb63-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate heterogeneity in 2 step model</span></span>
<span id="cb63-33"><a href="estimation-external.html#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb63-34"><a href="estimation-external.html#cb63-34" aria-hidden="true" tabindex="-1"></a>impact.meta <span class="ot">&lt;-</span> <span class="fu">uvmeta</span>( <span class="at">r=</span>coef.matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,i], <span class="at">r.se=</span>se.matrix[<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>,i])</span>
<span id="cb63-35"><a href="estimation-external.html#cb63-35" aria-hidden="true" tabindex="-1"></a>coef.matrix[<span class="dv">20</span>,i] <span class="ot">&lt;-</span> impact.meta<span class="sc">$</span>est</span>
<span id="cb63-36"><a href="estimation-external.html#cb63-36" aria-hidden="true" tabindex="-1"></a>se.matrix[<span class="dv">20</span>,i]   <span class="ot">&lt;-</span> impact.meta<span class="sc">$</span>se</span>
<span id="cb63-37"><a href="estimation-external.html#cb63-37" aria-hidden="true" tabindex="-1"></a>coef.matrix[<span class="dv">21</span>,i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(impact.meta<span class="sc">$</span>tau)</span>
<span id="cb63-38"><a href="estimation-external.html#cb63-38" aria-hidden="true" tabindex="-1"></a>coef.matrix[<span class="dv">22</span>,i] <span class="ot">&lt;-</span> impact.meta<span class="sc">$</span>pi.lb</span>
<span id="cb63-39"><a href="estimation-external.html#cb63-39" aria-hidden="true" tabindex="-1"></a>coef.matrix[<span class="dv">23</span>,i] <span class="ot">&lt;-</span> impact.meta<span class="sc">$</span>pi.ub</span>
<span id="cb63-40"><a href="estimation-external.html#cb63-40" aria-hidden="true" tabindex="-1"></a>} <span class="co"># end loop over 4 columns of per study estimates</span></span>
<span id="cb63-41"><a href="estimation-external.html#cb63-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-42"><a href="estimation-external.html#cb63-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Made Tabe 14.2; SE estimates separate</span></span>
<span id="cb63-43"><a href="estimation-external.html#cb63-43" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(coef.matrix, <span class="at">row.names =</span> T, <span class="at">col.names =</span> <span class="cn">NA</span>, <span class="at">caption =</span> <span class="st">&quot;Coefficients and heterogeneity by study&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:impact.lrm)Coefficients and heterogeneity by study
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Intercept
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
motor
</th>
<th style="text-align:right;">
pupils
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
-0.348
</td>
<td style="text-align:right;">
0.275
</td>
<td style="text-align:right;">
-0.479
</td>
<td style="text-align:right;">
0.380
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
-0.177
</td>
<td style="text-align:right;">
0.288
</td>
<td style="text-align:right;">
-0.577
</td>
<td style="text-align:right;">
0.360
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
-0.916
</td>
<td style="text-align:right;">
0.339
</td>
<td style="text-align:right;">
-0.367
</td>
<td style="text-align:right;">
0.495
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
-1.564
</td>
<td style="text-align:right;">
0.260
</td>
<td style="text-align:right;">
-0.259
</td>
<td style="text-align:right;">
0.616
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
-0.748
</td>
<td style="text-align:right;">
0.266
</td>
<td style="text-align:right;">
-0.604
</td>
<td style="text-align:right;">
0.534
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
-0.892
</td>
<td style="text-align:right;">
0.337
</td>
<td style="text-align:right;">
-0.515
</td>
<td style="text-align:right;">
0.586
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.060
</td>
<td style="text-align:right;">
0.412
</td>
<td style="text-align:right;">
-0.607
</td>
<td style="text-align:right;">
0.640
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
0.302
</td>
<td style="text-align:right;">
0.485
</td>
<td style="text-align:right;">
-0.677
</td>
<td style="text-align:right;">
0.629
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
-1.023
</td>
<td style="text-align:right;">
0.427
</td>
<td style="text-align:right;">
-0.239
</td>
<td style="text-align:right;">
0.414
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
-0.432
</td>
<td style="text-align:right;">
0.420
</td>
<td style="text-align:right;">
-0.690
</td>
<td style="text-align:right;">
0.696
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:right;">
-0.752
</td>
<td style="text-align:right;">
0.335
</td>
<td style="text-align:right;">
-0.440
</td>
<td style="text-align:right;">
0.277
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:right;">
-0.976
</td>
<td style="text-align:right;">
0.220
</td>
<td style="text-align:right;">
-0.386
</td>
<td style="text-align:right;">
0.526
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:right;">
-1.382
</td>
<td style="text-align:right;">
0.295
</td>
<td style="text-align:right;">
-0.456
</td>
<td style="text-align:right;">
0.806
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
-1.157
</td>
<td style="text-align:right;">
0.255
</td>
<td style="text-align:right;">
-0.360
</td>
<td style="text-align:right;">
0.298
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
-1.375
</td>
<td style="text-align:right;">
0.553
</td>
<td style="text-align:right;">
-0.846
</td>
<td style="text-align:right;">
1.035
</td>
</tr>
<tr>
<td style="text-align:left;">
naive
</td>
<td style="text-align:right;">
-0.720
</td>
<td style="text-align:right;">
0.339
</td>
<td style="text-align:right;">
-0.512
</td>
<td style="text-align:right;">
0.555
</td>
</tr>
<tr>
<td style="text-align:left;">
stratified
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.343
</td>
<td style="text-align:right;">
-0.517
</td>
<td style="text-align:right;">
0.528
</td>
</tr>
<tr>
<td style="text-align:left;">
one-stage
</td>
<td style="text-align:right;">
-0.677
</td>
<td style="text-align:right;">
0.342
</td>
<td style="text-align:right;">
-0.517
</td>
<td style="text-align:right;">
0.530
</td>
</tr>
<tr>
<td style="text-align:left;">
tau-1
</td>
<td style="text-align:right;">
0.356
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
two-stage
</td>
<td style="text-align:right;">
-0.735
</td>
<td style="text-align:right;">
0.343
</td>
<td style="text-align:right;">
-0.507
</td>
<td style="text-align:right;">
0.538
</td>
</tr>
<tr>
<td style="text-align:left;">
tau-2
</td>
<td style="text-align:right;">
0.438
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.121
</td>
<td style="text-align:right;">
0.135
</td>
</tr>
<tr>
<td style="text-align:left;">
Low pred
</td>
<td style="text-align:right;">
-1.730
</td>
<td style="text-align:right;">
0.182
</td>
<td style="text-align:right;">
-0.784
</td>
<td style="text-align:right;">
0.227
</td>
</tr>
<tr>
<td style="text-align:left;">
High pred
</td>
<td style="text-align:right;">
0.260
</td>
<td style="text-align:right;">
0.503
</td>
<td style="text-align:right;">
-0.231
</td>
<td style="text-align:right;">
0.849
</td>
</tr>
</tbody>
</table>
</div>
<div id="estimation-of-coefficients-naive-stratified-and-ipd-ma" class="section level3 hasAnchor" number="14.0.4">
<h3><span class="header-section-number">14.0.4</span> Estimation of coefficients: naive, stratified and IPD-MA<a href="estimation-external.html#estimation-of-coefficients-naive-stratified-and-ipd-ma" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We consider the estimates for the multivariable coefficients of 3 predictors: age, motor score, and pupils. Per study differences are modest; a forest plot might visualize the patterns. The model is:</p>
<p><code>lrm(mort~age10+motor.lin+pupil.lin, data=impact, subset=impact$study==i)</code></p>
<p>A naive summary estimate ignores the pooling:</p>
<p><code>lrm(mort~age10+motor.lin+pupil.lin, data=impact)</code></p>
<p>It produces overall estimates that are only slightly different than the estimates from a stratified model (with study as fixed effect). Also, similar estimates come for a one-step random effect analysis (with <code>lrm4::glmer</code>), or a two-step random effect analysis (with <code>metamisc::uvmeta</code>). Overall, the summary effect estimates for the predictors are quite similar.</p>
<p>The intercept differences between the studies are more substantial, but the summary estimates of the overall baseline risks are similar, all close to the naive estimate of -0.55. For the stratified analysis, a specific study intercept is taken as the reference, so the overall estimate is not available directly from <code>lrm</code>.</p>
<p>The between study variability is quantified with the parameter tau: slot <code>@beta</code> in glmer, and <code>$tau</code> in <code>metamisc::uvmeta</code>. The tau estimates were 0.356 with a one-step random effect analysis (with <code>lrm4::glmer</code>); and 0.438 with a two-step random effect analysis (with <code>metamisc::uvmeta</code>). Note that the latter tau estimate for the intercept depends on the coding of the predictors; it is the heterogeneity for a reference patient with zero values for the covariates, in our case; age 35, poor motor score and both pupils reacting.<br />
The prediction interval (from <code>metamisc::uvmeta</code>) was quite wide: <span class="math display">\[-1.7 - .2\]</span>, or odds ranging from exp(-1.73)=0.177 to exp(0.26)=1.3, or mortality risks between <code>plogis(-1.73)</code>=15% to <code>plogis(0.26)</code>=56% for a reference patient with all covariate values set to zero (age 35, poor motor score and both pupils reacting). We can also obtain prediction intervals for the predictor effects with the two-stage approach, which shows wider intervals than the standard 95% confidence intervals (either from fixed or random effect meta-analysis).</p>
</div>
<div id="estimation-of-standard-errors" class="section level3 hasAnchor" number="14.0.5">
<h3><span class="header-section-number">14.0.5</span> Estimation of standard errors<a href="estimation-external.html#estimation-of-standard-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The SE estimates (see below) for the predictor effects are very similar with a naive, stratified, or one-stage approach: 0.015 for age, around 0.02 for motor, and 0.03 for pupils. The pooled SEs are substantially smaller than the SE estimates per study. Even for the larger studies, the SEs are substantially wider: around 0.05 for age, around 0.07 for motor, and 0.09 for pupils. These SEs are fixed effect estimates, assuming a single, uniform association of each predictor with the outcome, 6-month mortality.</p>
<p>The random effect estimates allow for between study heterogeneity, and are wider: 0.024 for age, around 0.04 for motor, and 0.05 for pupils. For the model intercept, the naive approach underestimates the uncertainty by ignoring the clustering of the data. The one-stage and two-stage meta-analysis approach largely agree (SE = 0.12 - 0.14).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="estimation-external.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(se.matrix, <span class="at">row.names =</span> T, <span class="at">col.names =</span> <span class="cn">NA</span>, <span class="at">caption =</span> <span class="st">&quot;SE estimates&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:impact.se.estimates)SE estimates
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Intercept
</th>
<th style="text-align:right;">
age
</th>
<th style="text-align:right;">
motor
</th>
<th style="text-align:right;">
pupils
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
0.271
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
0.071
</td>
<td style="text-align:right;">
0.093
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
0.322
</td>
<td style="text-align:right;">
0.062
</td>
<td style="text-align:right;">
0.076
</td>
<td style="text-align:right;">
0.113
</td>
</tr>
<tr>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
0.423
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
0.119
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
0.267
</td>
<td style="text-align:right;">
0.052
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.105
</td>
</tr>
<tr>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
0.213
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.061
</td>
<td style="text-align:right;">
0.095
</td>
</tr>
<tr>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
0.394
</td>
<td style="text-align:right;">
0.084
</td>
<td style="text-align:right;">
0.121
</td>
<td style="text-align:right;">
0.169
</td>
</tr>
<tr>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
0.322
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.081
</td>
<td style="text-align:right;">
0.121
</td>
</tr>
<tr>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
0.349
</td>
<td style="text-align:right;">
0.065
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
0.152
</td>
</tr>
<tr>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
0.652
</td>
<td style="text-align:right;">
0.158
</td>
<td style="text-align:right;">
0.197
</td>
<td style="text-align:right;">
0.288
</td>
</tr>
<tr>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
0.316
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.082
</td>
<td style="text-align:right;">
0.131
</td>
</tr>
<tr>
<td style="text-align:left;">
11
</td>
<td style="text-align:right;">
0.282
</td>
<td style="text-align:right;">
0.056
</td>
<td style="text-align:right;">
0.080
</td>
<td style="text-align:right;">
0.120
</td>
</tr>
<tr>
<td style="text-align:left;">
12
</td>
<td style="text-align:right;">
0.402
</td>
<td style="text-align:right;">
0.095
</td>
<td style="text-align:right;">
0.109
</td>
<td style="text-align:right;">
0.164
</td>
</tr>
<tr>
<td style="text-align:left;">
13
</td>
<td style="text-align:right;">
0.355
</td>
<td style="text-align:right;">
0.084
</td>
<td style="text-align:right;">
0.107
</td>
<td style="text-align:right;">
0.134
</td>
</tr>
<tr>
<td style="text-align:left;">
14
</td>
<td style="text-align:right;">
0.302
</td>
<td style="text-align:right;">
0.066
</td>
<td style="text-align:right;">
0.091
</td>
<td style="text-align:right;">
0.110
</td>
</tr>
<tr>
<td style="text-align:left;">
15
</td>
<td style="text-align:right;">
0.488
</td>
<td style="text-align:right;">
0.068
</td>
<td style="text-align:right;">
0.134
</td>
<td style="text-align:right;">
0.185
</td>
</tr>
<tr>
<td style="text-align:left;">
naive
</td>
<td style="text-align:right;">
0.079
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.021
</td>
<td style="text-align:right;">
0.032
</td>
</tr>
<tr>
<td style="text-align:left;">
stratified
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
0.032
</td>
</tr>
<tr>
<td style="text-align:left;">
one-stage
</td>
<td style="text-align:right;">
0.123
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
0.032
</td>
</tr>
<tr>
<td style="text-align:left;">
tau-1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
two-stage
</td>
<td style="text-align:right;">
0.142
</td>
<td style="text-align:right;">
0.024
</td>
<td style="text-align:right;">
0.041
</td>
<td style="text-align:right;">
0.050
</td>
</tr>
<tr>
<td style="text-align:left;">
tau-2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Low pred
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
High pred
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<div id="estimation-for-a-specific-study-assuming-a-global-model-holds" class="section level3 hasAnchor" number="14.0.6">
<h3><span class="header-section-number">14.0.6</span> Estimation for a specific study, assuming a global model holds<a href="estimation-external.html#estimation-for-a-specific-study-assuming-a-global-model-holds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can estimate the intercept for study 14 with fixed estimates from the stratified model:</p>
<p><code>Mortality | Study 14 ~ intercept14 + offset(global linear predictor)</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="estimation-external.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stratified model, fixed effects</span></span>
<span id="cb65-2"><a href="estimation-external.html#cb65-2" aria-hidden="true" tabindex="-1"></a>fit.stratified <span class="ot">&lt;-</span> <span class="fu">lrm</span>(mort<span class="sc">~</span>age10<span class="sc">+</span>motor.lin<span class="sc">+</span>pupil.lin <span class="sc">+</span>name, <span class="at">data=</span>impact)</span>
<span id="cb65-3"><a href="estimation-external.html#cb65-3" aria-hidden="true" tabindex="-1"></a>study14 <span class="ot">&lt;-</span> impact[impact<span class="sc">$</span>study<span class="sc">==</span><span class="dv">14</span>, ] <span class="co"># selected reference set</span></span>
<span id="cb65-4"><a href="estimation-external.html#cb65-4" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.14</span> <span class="ot">&lt;-</span> <span class="fu">lrm.fit</span>(<span class="at">y=</span>study14<span class="sc">$</span>mort, </span>
<span id="cb65-5"><a href="estimation-external.html#cb65-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">offset=</span><span class="fu">as.matrix</span>(study14[,<span class="fu">c</span>(<span class="st">&quot;age10&quot;</span>,  <span class="st">&quot;motor.lin&quot;</span>, <span class="st">&quot;pupil.lin&quot;</span>)]) <span class="sc">%*%</span></span>
<span id="cb65-6"><a href="estimation-external.html#cb65-6" aria-hidden="true" tabindex="-1"></a>                    fit.stratified<span class="sc">$</span>coefficients[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] )</span>
<span id="cb65-7"><a href="estimation-external.html#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="estimation-external.html#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Fixed effect estimates for study 14, Tirilazad US (TIUS)</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</details>
<pre><code>## Fixed effect estimates for study 14, Tirilazad US (TIUS)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="estimation-external.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">coef</span>(fit<span class="fl">.14</span>), fit.stratified<span class="sc">$</span>coefficients[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) )</span></code></pre></div>
</details>
<pre><code>## Intercept     age10 motor.lin pupil.lin 
##    -1.179     0.343    -0.517     0.528</code></pre>
<hr />
</div>
</div>
<div id="the-aaa-study" class="section level2 unnumbered hasAnchor">
<h2>The AAA study<a href="estimation-external.html#the-aaa-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="descriptives-1" class="section level3 hasAnchor" number="14.0.7">
<h3><span class="header-section-number">14.0.7</span> Descriptives<a href="estimation-external.html#descriptives-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The AAA data set is rather small, with n=238 patients undergoing elective surgery for an Abdominal Aortic Aneurysm, and only 18 events (<code>STATUS==1</code>). The data set consists of patients operated on at the University Hospital Leiden (the Netherlands) between 1977 and 1988 (<a href="https://pubmed.ncbi.nlm.nih.gov/7575054/" title="Perioperative mortality of elective abdominal aortic aneurysm surgery. A clinical prediction rule based on literature and individual patient data">Steyerberg 1995</a>).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="estimation-external.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">html</span>(<span class="fu">describe</span>(AAA), <span class="at">scroll=</span><span class="cn">TRUE</span>) </span></code></pre></div>
</details>
<div style="width: 100ex; overflow: auto; height: 25ex;"> <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<script type="text/javascript">
<!--
    function expand_collapse(id) {
       var e = document.getElementById(id);
       var f = document.getElementById(id+"_earrows");
       if(e.style.display == 'none'){
          e.style.display = 'block';
          f.innerHTML = '&#9650';
       }
       else {
          e.style.display = 'none';
          f.innerHTML = '&#9660';
       }
    }
//-->
</script>
<style>
.earrows {color:silver;font-size:11px;}

fcap {
 font-family: Verdana;
 font-size: 12px;
 color: MidnightBlue
 }

smg {
 font-family: Verdana;
 font-size: 10px;
 color: &#808080;
}

hr.thinhr { margin-top: 0.15em; margin-bottom: 0.15em; }

span.xscript {
position: relative;
}
span.xscript sub {
position: absolute;
left: 0.1em;
bottom: -1ex;
}
</style>
 <title>AAA Descriptives</title> <font color="MidnightBlue"><div align=center><span style="font-weight:bold">AAA <br><br> 8  Variables   238  Observations</span></div></font> <hr class="thinhr"> <span style="font-weight:bold">SEX</span> <style>
 .hmisctable967793 {
 border: none;
 font-size: 85%;
 }
 .hmisctable967793 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable967793 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable967793">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>238</td><td>0</td><td>2</td><td>0.241</td><td>21</td><td>0.08824</td><td>0.1616</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">AGE10</span><div style='float: right; text-align: right;'><img src="data:image/png;base64,
iVBORw0KGgoAAAANSUhEUgAAAGcAAAANCAMAAACD8ID3AAAACVBMVEUAAADMzMz////1iUV5AAAAgElEQVQ4jd2SURKAIAhEt+5/6MBgIiOghn7yA1dHeYKLpWEA+ZG1YSDP8oYzpQX+wLHhWw5NlhPDcqcYS4mvRNN0qMx01XoubZJ6JGht9/frTTo3zOFEHxVxnHwVjvtbDzmJnl4TcGyjuzisyCTDJ2oWNRFvDC2+qmnd2heal9UGFasG90w3jA8AAAAASUVORK5CYII=" alt="image" /></div> <style>
 .hmisctable333366 {
 border: none;
 font-size: 74%;
 }
 .hmisctable333366 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable333366 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable333366">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Mean</th><th>Gmd</th><th>.05</th><th>.10</th><th>.25</th><th>.50</th><th>.75</th><th>.90</th><th>.95</th></tr>
 <tr><td>238</td><td>0</td><td>55</td><td>0.999</td><td>6.635</td><td>0.8432</td><td>5.400</td><td>5.600</td><td>6.100</td><td>6.700</td><td>7.100</td><td>7.500</td><td>7.815</td></tr>
 </table>
 <span style="font-size: 85%;"><font color="MidnightBlue">lowest</font> : 4.3 4.5 4.9 4.9 5.0 ,  <font color="MidnightBlue">highest</font>: 7.9 7.9 8.0 8.2 8.4</span> <hr class="thinhr"> <span style="font-weight:bold">MI</span> <style>
 .hmisctable225557 {
 border: none;
 font-size: 85%;
 }
 .hmisctable225557 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable225557 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable225557">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>238</td><td>0</td><td>2</td><td>0.553</td><td>58</td><td>0.2437</td><td>0.3702</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">CHF</span> <style>
 .hmisctable684353 {
 border: none;
 font-size: 85%;
 }
 .hmisctable684353 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable684353 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable684353">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>238</td><td>0</td><td>2</td><td>0.669</td><td>80</td><td>0.3361</td><td>0.4482</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">ISCHEMIA</span> <style>
 .hmisctable466833 {
 border: none;
 font-size: 85%;
 }
 .hmisctable466833 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable466833 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable466833">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>238</td><td>0</td><td>2</td><td>0.681</td><td>83</td><td>0.3487</td><td>0.4562</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">LUNG</span> <style>
 .hmisctable346297 {
 border: none;
 font-size: 85%;
 }
 .hmisctable346297 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable346297 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable346297">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>238</td><td>0</td><td>2</td><td>0.46</td><td>45</td><td>0.1891</td><td>0.3079</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">RENAL</span> <style>
 .hmisctable165159 {
 border: none;
 font-size: 85%;
 }
 .hmisctable165159 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable165159 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable165159">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>238</td><td>0</td><td>2</td><td>0.177</td><td>15</td><td>0.06303</td><td>0.1186</td></tr>
 </table>
 <hr class="thinhr"> <span style="font-weight:bold">STATUS</span> <style>
 .hmisctable697957 {
 border: none;
 font-size: 85%;
 }
 .hmisctable697957 td {
 text-align: center;
 padding: 0 1ex 0 1ex;
 }
 .hmisctable697957 th {
 color: MidnightBlue;
 text-align: center;
 padding: 0 1ex 0 1ex;
 font-weight: normal;
 }
 </style>
 <table class="hmisctable697957">
 <tr><th>n</th><th>missing</th><th>distinct</th><th>Info</th><th>Sum</th><th>Mean</th><th>Gmd</th></tr>
 <tr><td>238</td><td>0</td><td>2</td><td>0.21</td><td>18</td><td>0.07563</td><td>0.1404</td></tr>
 </table>
 <hr class="thinhr"> </div>
</div>
<div id="literature-univariate-estimates-table-14.4" class="section level3 hasAnchor" number="14.0.8">
<h3><span class="header-section-number">14.0.8</span> Literature, univariate estimates: Table 14.4<a href="estimation-external.html#literature-univariate-estimates-table-14.4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We consider the development of a prediction model for in-hospital mortality after elective surgery for AAA. We consider predictors that are identified as relevant in the literature and that are available in the local data. We performed a literature review to obtain univariate estimates of regression coefficients from publications in PubMed between 1980 and 1994. The selection was limited to English-language studies, which had to contain frequency data on the association of a potential predictor and surgical mortality, either in tables or mentioned in the text.</p>
<p>The pooled log odds ratio estimates (=logistic regression coefficients) from a fixed effect or random effect procedure. The estimates agreed up to 2 decimals usually. We compare the univariate coefficients from the literature (fixed or random pooled estimates) to the estimates from the local data.</p>
<ul>
<li><p>the effect for <code>SEX</code> was small, a slightly stronger in the literature (0.36 vs 0.28)</p></li>
<li><p>the age effect (per decade) was strong. A literature coefficient of 0.79 (slightly smaller than the local 0.98 estimate) implies a exp(0.79)=2.2 times higher odds of mortality per 10 years older. So, as often in surgical procedures, age was a strong predictor (<a href="https://pubmed.ncbi.nlm.nih.gov/11525104/" title="Operative mortality with elective surgery in older adults">Finlayson 2001</a>)</p></li>
<li><p>the univariate estimates for cardiac comorbidity (a history of <code>MI</code>, presence of <code>CHF</code>, presence of <code>ISCHEMIA</code>) were all a bit smaller in the literature than the local data</p></li>
<li><p><code>LUNG</code> or <code>RENAL</code> comorbidity showed quite similar univariate associations in the literature and the IPD, so using or ignoring the literature would result in similar coefficient estimates</p></li>
</ul>
<p>The standard errors (SE) were smaller for the literature estimates, as expected. The pooled estimates of the predictors <code>SEX</code> and <code>AGE10</code> were based on large numbers and many studies, especially for age. This leads to a relatively small fixed effect SE. For other predictors, the number of studies was small leading to a modestly smaller SE, e.g. for cardiac, lung and renal comorbidity. The random effect SE was larger for <code>SEX</code> and <code>AGE10</code>, including the between study heterogeneity in effect estimates. We used the random effect estimates of the coefficients with the random effect SE for the adaptation procedures.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="estimation-external.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The following estimates come from a univariable logistic regression analysis</span></span>
<span id="cb70-2"><a href="estimation-external.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fixed effects, better random effect estimates</span></span>
<span id="cb70-3"><a href="estimation-external.html#cb70-3" aria-hidden="true" tabindex="-1"></a>lit.coefficients.f  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">1.44</span>),<span class="fu">log</span>(<span class="fl">2.20</span>),<span class="fu">log</span>(<span class="fl">2.80</span>),<span class="fu">log</span>(<span class="fl">4.89</span>),<span class="fu">log</span>(<span class="fl">4.58</span>),</span>
<span id="cb70-4"><a href="estimation-external.html#cb70-4" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">log</span>(<span class="fl">3.75</span>),<span class="fu">log</span>(<span class="fl">2.43</span>))</span>
<span id="cb70-5"><a href="estimation-external.html#cb70-5" aria-hidden="true" tabindex="-1"></a>lit.se.f            <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.08</span>,<span class="fl">0.06</span>,<span class="fl">0.27</span>,<span class="fl">0.33</span>,<span class="fl">0.31</span>,<span class="fl">0.25</span>,<span class="fl">0.23</span>)</span>
<span id="cb70-6"><a href="estimation-external.html#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Random effects</span></span>
<span id="cb70-7"><a href="estimation-external.html#cb70-7" aria-hidden="true" tabindex="-1"></a>lit.coefficients    <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3606</span>,<span class="fl">0.788</span>,<span class="fl">1.034</span>,<span class="fl">1.590</span>,<span class="fl">1.514</span>,<span class="fl">1.302</span>,<span class="fl">0.8502</span>)</span>
<span id="cb70-8"><a href="estimation-external.html#cb70-8" aria-hidden="true" tabindex="-1"></a>lit.se          <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.176</span>,<span class="fl">0.112</span>,<span class="fl">0.317</span>,<span class="fl">0.4109</span>,<span class="fl">0.378</span>,<span class="fl">0.2595</span>,<span class="fl">0.2367</span>)</span>
<span id="cb70-9"><a href="estimation-external.html#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="estimation-external.html#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Local data multivariable estimates</span></span>
<span id="cb70-11"><a href="estimation-external.html#cb70-11" aria-hidden="true" tabindex="-1"></a>full <span class="ot">&lt;-</span> <span class="fu">lrm</span>(STATUS<span class="sc">~</span>SEX<span class="sc">+</span>AGE10<span class="sc">+</span>MI<span class="sc">+</span>CHF<span class="sc">+</span>ISCHEMIA<span class="sc">+</span>RENAL<span class="sc">+</span>LUNG,<span class="at">data=</span>AAA,<span class="at">x=</span>T,<span class="at">y=</span>T)</span>
<span id="cb70-12"><a href="estimation-external.html#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="estimation-external.html#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Local data univariate estimates</span></span>
<span id="cb70-14"><a href="estimation-external.html#cb70-14" aria-hidden="true" tabindex="-1"></a>local.coef <span class="ot">&lt;-</span> local.se <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">7</span>)</span>
<span id="cb70-15"><a href="estimation-external.html#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb70-16"><a href="estimation-external.html#cb70-16" aria-hidden="true" tabindex="-1"></a>fit.ind.x       <span class="ot">&lt;-</span> <span class="fu">lrm.fit</span>(<span class="at">y=</span>full<span class="sc">$</span>y,<span class="at">x=</span>full<span class="sc">$</span>x[,i],<span class="at">maxit=</span><span class="dv">25</span>)</span>
<span id="cb70-17"><a href="estimation-external.html#cb70-17" aria-hidden="true" tabindex="-1"></a>local.coef[i] <span class="ot">&lt;-</span> fit.ind.x<span class="sc">$</span>coef[<span class="dv">2</span>]</span>
<span id="cb70-18"><a href="estimation-external.html#cb70-18" aria-hidden="true" tabindex="-1"></a>local.se[i]   <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(fit.ind.x<span class="sc">$</span>var[<span class="dv">2</span>,<span class="dv">2</span>]) }</span>
<span id="cb70-19"><a href="estimation-external.html#cb70-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-20"><a href="estimation-external.html#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Table 14.4</span></span>
<span id="cb70-21"><a href="estimation-external.html#cb70-21" aria-hidden="true" tabindex="-1"></a>tab14 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(local.coef, local.se, </span>
<span id="cb70-22"><a href="estimation-external.html#cb70-22" aria-hidden="true" tabindex="-1"></a>            lit.coefficients.f, lit.se.f, </span>
<span id="cb70-23"><a href="estimation-external.html#cb70-23" aria-hidden="true" tabindex="-1"></a>            lit.coefficients, lit.se)</span>
<span id="cb70-24"><a href="estimation-external.html#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">names</span>(full<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb70-25"><a href="estimation-external.html#cb70-25" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;local.coef&quot;</span>, <span class="st">&quot;local.se&quot;</span>, </span>
<span id="cb70-26"><a href="estimation-external.html#cb70-26" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;fixed.coef&quot;</span>, <span class="st">&quot;fixed.se&quot;</span>, </span>
<span id="cb70-27"><a href="estimation-external.html#cb70-27" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;random.coef&quot;</span>, <span class="st">&quot;random.se&quot;</span>)</span>
<span id="cb70-28"><a href="estimation-external.html#cb70-28" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tab14, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Univariate coefficients&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:AAA.lit.estimates)Univariate coefficients
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
local.coef
</th>
<th style="text-align:right;">
local.se
</th>
<th style="text-align:right;">
fixed.coef
</th>
<th style="text-align:right;">
fixed.se
</th>
<th style="text-align:right;">
random.coef
</th>
<th style="text-align:right;">
random.se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SEX
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.18
</td>
</tr>
<tr>
<td style="text-align:left;">
AGE10
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.11
</td>
</tr>
<tr>
<td style="text-align:left;">
MI
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
1.78
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
1.59
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
1.59
</td>
<td style="text-align:right;">
0.41
</td>
</tr>
<tr>
<td style="text-align:left;">
ISCHEMIA
</td>
<td style="text-align:right;">
1.72
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
1.52
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
1.51
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr>
<td style="text-align:left;">
RENAL
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
1.32
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
1.30
</td>
<td style="text-align:right;">
0.26
</td>
</tr>
<tr>
<td style="text-align:left;">
LUNG
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.24
</td>
</tr>
</tbody>
</table>
</div>
<div id="a-simple-prediction-model-table-14.5" class="section level3 hasAnchor" number="14.0.9">
<h3><span class="header-section-number">14.0.9</span> A simple prediction model: Table 14.5<a href="estimation-external.html#a-simple-prediction-model-table-14.5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We may fit a simple model for in-hospital mortality based on predictors that are known to be relevant from the literature, and that are available in the local data. The standard logistic model with maximum likelihood is obtained from: <code>lrm(STATUS~SEX+AGE10+MI+CHF+ISCHEMIA+RENAL+LUNG,data=AAA)</code></p>
<p>We may apply a shrinkage factor, estimated by bootstrapping using the <code>rms::validate</code> function. And finally we explore penalized logistic regression, using <code>rms::pentrace</code>. We find that</p>
<ul>
<li><p>the estimated coefficients are shrunken towards zero with both the bootstrap shrinkage approach and the penalized maximum likelihood approach.</p></li>
<li><p>the estimated shrinkage factor is 0.66, the reduction in c statistic is from 0.83 to 0.76, the reduction in R^2 is from 24 to 10%; this is all in agreement with the small effective sample size (18 events).</p></li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="estimation-external.html#cb71-1" aria-hidden="true" tabindex="-1"></a>full <span class="ot">&lt;-</span> <span class="fu">lrm</span>(STATUS<span class="sc">~</span>SEX<span class="sc">+</span>AGE10<span class="sc">+</span>MI<span class="sc">+</span>CHF<span class="sc">+</span>ISCHEMIA<span class="sc">+</span>RENAL<span class="sc">+</span>LUNG,<span class="at">data=</span>AAA,<span class="at">x=</span>T,<span class="at">y=</span>T)</span>
<span id="cb71-2"><a href="estimation-external.html#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="estimation-external.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate shrinkage factor</span></span>
<span id="cb71-4"><a href="estimation-external.html#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb71-5"><a href="estimation-external.html#cb71-5" aria-hidden="true" tabindex="-1"></a>full.validate <span class="ot">&lt;-</span> <span class="fu">validate</span>(full, <span class="at">B=</span><span class="dv">500</span>, <span class="at">maxit=</span><span class="dv">10</span>)</span></code></pre></div>
</details>
<pre><code>## 
## Divergence or singularity in 3 samples</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="estimation-external.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply shrinkage factor on model coefficients</span></span>
<span id="cb73-2"><a href="estimation-external.html#cb73-2" aria-hidden="true" tabindex="-1"></a>full.shrunk.coefficients    <span class="ot">&lt;-</span> full.validate[<span class="st">&quot;Slope&quot;</span>,<span class="st">&quot;index.corrected&quot;</span>] <span class="sc">*</span> full<span class="sc">$</span>coefficients</span>
<span id="cb73-3"><a href="estimation-external.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust intercept with lp as offset variable</span></span>
<span id="cb73-4"><a href="estimation-external.html#cb73-4" aria-hidden="true" tabindex="-1"></a>lp.AAA  <span class="ot">&lt;-</span> full<span class="sc">$</span>x <span class="sc">%*%</span> full.shrunk.coefficients[<span class="dv">2</span><span class="sc">:</span>(<span class="fu">ncol</span>(full<span class="sc">$</span>x)<span class="sc">+</span><span class="dv">1</span>)]</span>
<span id="cb73-5"><a href="estimation-external.html#cb73-5" aria-hidden="true" tabindex="-1"></a>fit.offset  <span class="ot">&lt;-</span> <span class="fu">lrm.fit</span>(<span class="at">y=</span>full<span class="sc">$</span>y, <span class="at">offset=</span>lp.AAA)</span>
<span id="cb73-6"><a href="estimation-external.html#cb73-6" aria-hidden="true" tabindex="-1"></a>full.shrunk.coefficients[<span class="dv">1</span>] <span class="ot">&lt;-</span> fit.offset<span class="sc">$</span>coef[<span class="dv">1</span>]</span>
<span id="cb73-7"><a href="estimation-external.html#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="estimation-external.html#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Full model, penalized estimation</span></span>
<span id="cb73-9"><a href="estimation-external.html#cb73-9" aria-hidden="true" tabindex="-1"></a>penalty <span class="ot">&lt;-</span> <span class="fu">pentrace</span>(full,<span class="at">penalty=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="dv">16</span>,<span class="dv">24</span>,<span class="dv">36</span>,<span class="dv">48</span>),<span class="at">maxit=</span><span class="dv">25</span>)</span>
<span id="cb73-10"><a href="estimation-external.html#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(penalty)</span></code></pre></div>
</details>
<p><img src="fig/AAA.models-1.png" width="672" /><img src="fig/AAA.models-2.png" width="672" /></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="estimation-external.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The optimal penalty was&quot;</span>, penalty<span class="sc">$</span>penalty, <span class="st">&quot;for effective df around 3.5 rather than 7 df</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
</details>
<pre><code>## The optimal penalty was 16 for effective df around 3.5 rather than 7 df</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="estimation-external.html#cb76-1" aria-hidden="true" tabindex="-1"></a>full.penalized <span class="ot">&lt;-</span> <span class="fu">update</span>(full, <span class="at">penalty=</span>penalty<span class="sc">$</span>penalty)</span>
<span id="cb76-2"><a href="estimation-external.html#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="estimation-external.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the 3 sets of coefs</span></span>
<span id="cb76-4"><a href="estimation-external.html#cb76-4" aria-hidden="true" tabindex="-1"></a>coef.mat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(full<span class="sc">$</span>coef, full.shrunk.coefficients, full.penalized<span class="sc">$</span>coef )</span>
<span id="cb76-5"><a href="estimation-external.html#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coef.mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Full, ML&quot;</span>, <span class="st">&quot;Shrinkage&quot;</span>, <span class="st">&quot;Penalized&quot;</span>)</span>
<span id="cb76-6"><a href="estimation-external.html#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="estimation-external.html#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(coef.mat, <span class="at">digits=</span><span class="dv">2</span>, </span>
<span id="cb76-8"><a href="estimation-external.html#cb76-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Estimated local multivariable regression coefficients in IPD&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:AAA.models)Estimated local multivariable regression coefficients in IPD
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Full, ML
</th>
<th style="text-align:right;">
Shrinkage
</th>
<th style="text-align:right;">
Penalized
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-8.10
</td>
<td style="text-align:right;">
-6.04
</td>
<td style="text-align:right;">
-5.60
</td>
</tr>
<tr>
<td style="text-align:left;">
SEX
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
AGE10
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
MI
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
1.04
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
0.64
</td>
</tr>
<tr>
<td style="text-align:left;">
ISCHEMIA
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.60
</td>
</tr>
<tr>
<td style="text-align:left;">
RENAL
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.71
</td>
</tr>
<tr>
<td style="text-align:left;">
LUNG
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="estimation-external.html#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># shrinkage factor: slope of lp</span></span>
<span id="cb77-2"><a href="estimation-external.html#cb77-2" aria-hidden="true" tabindex="-1"></a>cstat <span class="ot">&lt;-</span> full.validate[<span class="dv">1</span>,]</span>
<span id="cb77-3"><a href="estimation-external.html#cb77-3" aria-hidden="true" tabindex="-1"></a>cstat[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>)] <span class="ot">&lt;-</span> full.validate[<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="dv">5</span>)] <span class="sc">*</span> <span class="fl">0.5</span> <span class="sc">+</span> <span class="fl">0.5</span> <span class="co"># c = D/2 + 0.5</span></span>
<span id="cb77-4"><a href="estimation-external.html#cb77-4" aria-hidden="true" tabindex="-1"></a>cstat[<span class="dv">4</span>] <span class="ot">&lt;-</span> full.validate[<span class="dv">1</span>,<span class="dv">4</span>] <span class="sc">*</span> <span class="fl">0.5</span> <span class="co"># optimism in c</span></span>
<span id="cb77-5"><a href="estimation-external.html#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="estimation-external.html#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># show key performance measures, including c statistic, R2, and estimated shrinkage factor</span></span>
<span id="cb77-7"><a href="estimation-external.html#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">rbind</span>(cstat, full.validate[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,]), <span class="at">digits =</span> <span class="dv">2</span>, </span>
<span id="cb77-8"><a href="estimation-external.html#cb77-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Internally validated performance&quot;</span> )</span></code></pre></div>
</details>
<table>
<caption>
(#tab:AAA.models)Internally validated performance
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
index.orig
</th>
<th style="text-align:right;">
training
</th>
<th style="text-align:right;">
test
</th>
<th style="text-align:right;">
optimism
</th>
<th style="text-align:right;">
index.corrected
</th>
<th style="text-align:right;">
n
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
cstat
</td>
<td style="text-align:right;">
0.83
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
497
</td>
</tr>
<tr>
<td style="text-align:left;">
Dxy
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
0.72
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.52
</td>
<td style="text-align:right;">
497
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
497
</td>
</tr>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
-0.69
</td>
<td style="text-align:right;">
0.69
</td>
<td style="text-align:right;">
-0.69
</td>
<td style="text-align:right;">
497
</td>
</tr>
<tr>
<td style="text-align:left;">
Slope
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.66
</td>
<td style="text-align:right;">
497
</td>
</tr>
</tbody>
</table>
</div>
<div id="adaptation-of-univariate-coefficients-table-14.6" class="section level3 hasAnchor" number="14.0.10">
<h3><span class="header-section-number">14.0.10</span> Adaptation of univariate coefficients: Table 14.6<a href="estimation-external.html#adaptation-of-univariate-coefficients-table-14.6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We implement two variants of an “adaptation method” that takes advantage of univariate literature data in the estimation of the multivariable regression coefficients in a local prediction model.</p>
<p>Adaptation method 1 is simple: beta m|(I+L) = beta u|L + (beta m|I - beta u|I), where beta m|(I+L) is the set of multivariable coefficients (“m”) for the predictors considering both individual patient data (“I”) and literature data (“L”). The univariate coefficients are denoted as “beta u”.</p>
<p>The adaptation factor (beta m|I - beta u|I) is the difference between multivariable and univariate coefficient in the IPD data set. The adaptation factor adapts beta u|L, the set of univariate estimates from the literature.</p>
<p>Adaptation method 2 is a bit more complex: beta m|(I+L) = beta m|I + <em>c</em> * (beta u|L - beta u|I), with c a factor between 0 and 1.</p>
<ul>
<li><p>With <em>c</em>=0, adaptation method 2 is ignoring literature information; we simply use the mulktivariable coefficients from our local data.</p></li>
<li><p>With <em>c</em>=1, adaptation method 2 is the same as adaptation method 1, rewritten as:<br />
beta m|(I+L) = beta m|I + beta u|L - beta u|I.</p></li>
<li><p>The optimal value if c can be derived as a combination of the variance estimates of the components beta m|, beta u|L, and beta u|I with the correlation between univariate and multivariable coefficient in the individual patient data: <em>r</em>(beta m|I, beta u|I). The latter correlation can be estimated empirically by a bootstrap procedure. We estimate coefficients in many bootstap samples drawn with replacement and calculate the correlation after excluding outliers.</p></li>
</ul>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="estimation-external.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb78-2"><a href="estimation-external.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># we need the user written function</span></span>
<span id="cb78-3"><a href="estimation-external.html#cb78-3" aria-hidden="true" tabindex="-1"></a>full.uni.mult.cor   <span class="ot">&lt;-</span> <span class="fu">bootcor.uni.mult</span>(full, <span class="at">group=</span>full<span class="sc">$</span>y, <span class="at">B=</span><span class="dv">500</span>, <span class="at">maxit=</span><span class="dv">10</span>, </span>
<span id="cb78-4"><a href="estimation-external.html#cb78-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">trim=</span>.<span class="dv">1</span>,<span class="at">save.indices =</span> T)</span></code></pre></div>
</details>
<pre><code>## Bootsample: 10 20 30 40 50 60 70 80 90 100 110 120 130 140 150 160 170 180 190 200 210 220 230 240 250 260 270 280 290 300 310 320 330 340 350 360 370 380 390 400 410 420 430 440 450 460 470 480 490 500 
## Number of valid bootstraps for correlation and shrinkage:  484
## Correlation coefficients: 0.36 0.84 0.91 0.9 0.89 0.97 0.91 
## Shrinkage: 0.72</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="estimation-external.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># outliers are removed by &#39;outliers&#39; package</span></span>
<span id="cb80-2"><a href="estimation-external.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># full.uni.mult.cor[4]  # matrix with results per bootstrap</span></span>
<span id="cb80-3"><a href="estimation-external.html#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="estimation-external.html#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># now do adaptation method approach</span></span>
<span id="cb80-5"><a href="estimation-external.html#cb80-5" aria-hidden="true" tabindex="-1"></a>adapt.factors   <span class="ot">&lt;-</span> adapt.coefficients   <span class="ot">&lt;-</span> adapt.var <span class="ot">&lt;-</span> adapt.coef.Gr   <span class="ot">&lt;-</span> adapt.var.Gr <span class="ot">&lt;-</span> </span>
<span id="cb80-6"><a href="estimation-external.html#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>)</span>
<span id="cb80-7"><a href="estimation-external.html#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="estimation-external.html#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Adaptation method 1, simple, just take the difference in own data between m and u estimates for coefficients</span></span>
<span id="cb80-9"><a href="estimation-external.html#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb80-10"><a href="estimation-external.html#cb80-10" aria-hidden="true" tabindex="-1"></a>fit.ind.x       <span class="ot">&lt;-</span> <span class="fu">lrm.fit</span>(<span class="at">y=</span>full<span class="sc">$</span>y,<span class="at">x=</span>full<span class="sc">$</span>x[,i],<span class="at">maxit=</span><span class="dv">25</span>)</span>
<span id="cb80-11"><a href="estimation-external.html#cb80-11" aria-hidden="true" tabindex="-1"></a>adapt.coef.Gr[i] <span class="ot">&lt;-</span> full<span class="sc">$</span>coefficients[i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb80-12"><a href="estimation-external.html#cb80-12" aria-hidden="true" tabindex="-1"></a>                <span class="dv">1</span> <span class="sc">*</span> (lit.coefficients[i] <span class="sc">-</span> fit.ind.x<span class="sc">$</span>coefficients[<span class="dv">2</span>])</span>
<span id="cb80-13"><a href="estimation-external.html#cb80-13" aria-hidden="true" tabindex="-1"></a>adapt.var.Gr[i] <span class="ot">&lt;-</span> full<span class="sc">$</span>var[i<span class="sc">+</span><span class="dv">1</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">-</span> fit.ind.x<span class="sc">$</span>var[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">+</span> lit.se[i]<span class="sc">^</span><span class="dv">2</span> </span>
<span id="cb80-14"><a href="estimation-external.html#cb80-14" aria-hidden="true" tabindex="-1"></a> } <span class="co"># end adaptation 1</span></span>
<span id="cb80-15"><a href="estimation-external.html#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="estimation-external.html#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adaptation method 2: optimal adaptation factors</span></span>
<span id="cb80-17"><a href="estimation-external.html#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>) {</span>
<span id="cb80-18"><a href="estimation-external.html#cb80-18" aria-hidden="true" tabindex="-1"></a>fit.ind.x       <span class="ot">&lt;-</span> <span class="fu">lrm.fit</span>(<span class="at">y=</span>full<span class="sc">$</span>y,<span class="at">x=</span>full<span class="sc">$</span>x[,i],<span class="at">maxit=</span><span class="dv">25</span>)</span>
<span id="cb80-19"><a href="estimation-external.html#cb80-19" aria-hidden="true" tabindex="-1"></a>adapt.factors[i]    <span class="ot">&lt;-</span> (full.uni.mult.cor<span class="sc">$</span>r[i] <span class="sc">*</span> </span>
<span id="cb80-20"><a href="estimation-external.html#cb80-20" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">sqrt</span>(full<span class="sc">$</span>var[i<span class="sc">+</span><span class="dv">1</span>,i<span class="sc">+</span><span class="dv">1</span>]) <span class="sc">*</span> <span class="fu">sqrt</span>(fit.ind.x<span class="sc">$</span>var[<span class="dv">2</span>,<span class="dv">2</span>]) ) <span class="sc">/</span> </span>
<span id="cb80-21"><a href="estimation-external.html#cb80-21" aria-hidden="true" tabindex="-1"></a>                      (lit.se[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> fit.ind.x<span class="sc">$</span>var[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb80-22"><a href="estimation-external.html#cb80-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-23"><a href="estimation-external.html#cb80-23" aria-hidden="true" tabindex="-1"></a>adapt.coefficients[i]   <span class="ot">&lt;-</span> full<span class="sc">$</span>coefficients[i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">+</span> </span>
<span id="cb80-24"><a href="estimation-external.html#cb80-24" aria-hidden="true" tabindex="-1"></a>                    adapt.factors[i] <span class="sc">*</span> (lit.coefficients[i] <span class="sc">-</span> fit.ind.x<span class="sc">$</span>coefficients[<span class="dv">2</span>])</span>
<span id="cb80-25"><a href="estimation-external.html#cb80-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-26"><a href="estimation-external.html#cb80-26" aria-hidden="true" tabindex="-1"></a>adapt.var[i]        <span class="ot">&lt;-</span> full<span class="sc">$</span>var[i<span class="sc">+</span><span class="dv">1</span>,i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>(full.uni.mult.cor<span class="sc">$</span>r[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> fit.ind.x<span class="sc">$</span>var[<span class="dv">2</span>,<span class="dv">2</span>] <span class="sc">/</span> </span>
<span id="cb80-27"><a href="estimation-external.html#cb80-27" aria-hidden="true" tabindex="-1"></a>                (lit.se[i]<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> fit.ind.x<span class="sc">$</span>var[<span class="dv">2</span>,<span class="dv">2</span>]))) } <span class="co"># end adaptation 2</span></span>
<span id="cb80-28"><a href="estimation-external.html#cb80-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-29"><a href="estimation-external.html#cb80-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-30"><a href="estimation-external.html#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Store all coefficients and related measures in a nice matrix</span></span>
<span id="cb80-31"><a href="estimation-external.html#cb80-31" aria-hidden="true" tabindex="-1"></a>tab14 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lit.coefficients, local.coef, full<span class="sc">$</span>coef[<span class="sc">-</span><span class="dv">1</span>], full.uni.mult.cor<span class="sc">$</span>r,</span>
<span id="cb80-32"><a href="estimation-external.html#cb80-32" aria-hidden="true" tabindex="-1"></a>               adapt.factors, adapt.coef.Gr, adapt.coefficients, </span>
<span id="cb80-33"><a href="estimation-external.html#cb80-33" aria-hidden="true" tabindex="-1"></a>               full.shrunk.coefficients[<span class="sc">-</span><span class="dv">1</span>], full.penalized<span class="sc">$</span>coef[<span class="sc">-</span><span class="dv">1</span>] )</span>
<span id="cb80-34"><a href="estimation-external.html#cb80-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">names</span>(full<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb80-35"><a href="estimation-external.html#cb80-35" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;random.coef.u&quot;</span>, <span class="st">&quot;local.coef.u&quot;</span>, <span class="st">&quot;local.coef.m&quot;</span>, <span class="st">&quot;r&quot;</span>,</span>
<span id="cb80-36"><a href="estimation-external.html#cb80-36" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;adapt.opt&quot;</span>, <span class="st">&quot;adapted.1.m&quot;</span>, <span class="st">&quot;adapted.2.m&quot;</span>,</span>
<span id="cb80-37"><a href="estimation-external.html#cb80-37" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;shrunk.m&quot;</span>, <span class="st">&quot;penalized.m&quot;</span>)</span>
<span id="cb80-38"><a href="estimation-external.html#cb80-38" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tab14, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;Coefficients for AAA modeling&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:adaptation.1)Coefficients for AAA modeling
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
random.coef.u
</th>
<th style="text-align:right;">
local.coef.u
</th>
<th style="text-align:right;">
local.coef.m
</th>
<th style="text-align:right;">
r
</th>
<th style="text-align:right;">
adapt.opt
</th>
<th style="text-align:right;">
adapted.1.m
</th>
<th style="text-align:right;">
adapted.2.m
</th>
<th style="text-align:right;">
shrunk.m
</th>
<th style="text-align:right;">
penalized.m
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SEX
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.19
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
AGE10
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.98
</td>
<td style="text-align:right;">
0.58
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.32
</td>
</tr>
<tr>
<td style="text-align:left;">
MI
</td>
<td style="text-align:right;">
1.03
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.49
</td>
<td style="text-align:right;">
0.55
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
1.59
</td>
<td style="text-align:right;">
1.78
</td>
<td style="text-align:right;">
1.04
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.63
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.92
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
0.64
</td>
</tr>
<tr>
<td style="text-align:left;">
ISCHEMIA
</td>
<td style="text-align:right;">
1.51
</td>
<td style="text-align:right;">
1.72
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
0.89
</td>
<td style="text-align:right;">
0.68
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
0.65
</td>
<td style="text-align:right;">
0.60
</td>
</tr>
<tr>
<td style="text-align:left;">
RENAL
</td>
<td style="text-align:right;">
1.30
</td>
<td style="text-align:right;">
1.24
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
0.97
</td>
<td style="text-align:right;">
0.94
</td>
<td style="text-align:right;">
1.18
</td>
<td style="text-align:right;">
1.18
</td>
<td style="text-align:right;">
0.74
</td>
<td style="text-align:right;">
0.71
</td>
</tr>
<tr>
<td style="text-align:left;">
LUNG
</td>
<td style="text-align:right;">
0.85
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
0.84
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.37
</td>
</tr>
</tbody>
</table>
<div id="adaptation-results-coefficients-in-table-14.6" class="section level4 hasAnchor" number="14.0.10.1">
<h4><span class="header-section-number">14.0.10.1</span> Adaptation results: coefficients in Table 14.6<a href="estimation-external.html#adaptation-results-coefficients-in-table-14.6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first 3 columns show the estimates that are input for the adaptation approaches:</p>
<ol style="list-style-type: decimal">
<li>the random effect pooled estimates for the univariate associations (<strong>random.coef.u</strong>)</li>
<li>the local, or IPD, univariate associations (<strong>local.coef.u</strong>); and</li>
<li>the local multivariable associations (<strong>local.coef.m</strong>).</li>
</ol>
<p>The empirically estimated correlation <em>r</em> between local univariate and multivariable coefficients was between 0.36 for <code>SEX</code> and around 0.9 for other the predictors. The optimal adaptation factor (<strong>adapt.opt</strong>) was closely related to the estimate of <em>r</em>. Adaptation method 1 or 2 lead to similar estimates for the multivariable coefficient (beta m|(I+L), denoted as <strong>adapted.1.m</strong> and <strong>adapted.2.m</strong>). The adapted estimates are larger than shrunk or penalized estimates that only consider the local IPD.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="estimation-external.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Store all standard error estimates in a nice matrix</span></span>
<span id="cb81-2"><a href="estimation-external.html#cb81-2" aria-hidden="true" tabindex="-1"></a>tab14 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(lit.se, local.se, <span class="fu">sqrt</span>(<span class="fu">diag</span>(full<span class="sc">$</span>var)[<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb81-3"><a href="estimation-external.html#cb81-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">sqrt</span>(adapt.var.Gr), <span class="fu">sqrt</span>(adapt.var), </span>
<span id="cb81-4"><a href="estimation-external.html#cb81-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">sqrt</span>(<span class="fu">diag</span>(full.penalized<span class="sc">$</span>var)[<span class="sc">-</span><span class="dv">1</span>] ))</span>
<span id="cb81-5"><a href="estimation-external.html#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduction in variance</span></span>
<span id="cb81-6"><a href="estimation-external.html#cb81-6" aria-hidden="true" tabindex="-1"></a>reduct.var <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="sc">-</span> <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>adapt.var <span class="sc">/</span> <span class="fu">diag</span>(full<span class="sc">$</span>var)[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb81-7"><a href="estimation-external.html#cb81-7" aria-hidden="true" tabindex="-1"></a>tab14 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(tab14, reduct.var)</span>
<span id="cb81-8"><a href="estimation-external.html#cb81-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-9"><a href="estimation-external.html#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">names</span>(full<span class="sc">$</span>coefficients[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb81-10"><a href="estimation-external.html#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;random.u&quot;</span>, <span class="st">&quot;local.u&quot;</span>, <span class="st">&quot;local.m&quot;</span>,</span>
<span id="cb81-11"><a href="estimation-external.html#cb81-11" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;adapted.1&quot;</span>, <span class="st">&quot;adapted.2&quot;</span>,</span>
<span id="cb81-12"><a href="estimation-external.html#cb81-12" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;penalized.m&quot;</span>, <span class="st">&quot;% reduction variance adapt 2&quot;</span>)</span>
<span id="cb81-13"><a href="estimation-external.html#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tab14, <span class="at">digits=</span><span class="dv">2</span>, <span class="at">caption =</span> <span class="st">&quot;SE estimates and reduction in variance by adaptation&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:adaptation.se)SE estimates and reduction in variance by adaptation
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
random.u
</th>
<th style="text-align:right;">
local.u
</th>
<th style="text-align:right;">
local.m
</th>
<th style="text-align:right;">
adapted.1
</th>
<th style="text-align:right;">
adapted.2
</th>
<th style="text-align:right;">
penalized.m
</th>
<th style="text-align:right;">
% reduction variance adapt 2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
SEX
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.86
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.81
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
AGE10
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
65
</td>
</tr>
<tr>
<td style="text-align:left;">
MI
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.57
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
60
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0.47
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
52
</td>
</tr>
<tr>
<td style="text-align:left;">
ISCHEMIA
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
0.48
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0.38
</td>
<td style="text-align:right;">
54
</td>
</tr>
<tr>
<td style="text-align:left;">
RENAL
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.77
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.62
</td>
<td style="text-align:right;">
83
</td>
</tr>
<tr>
<td style="text-align:left;">
LUNG
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.53
</td>
<td style="text-align:right;">
0.59
</td>
<td style="text-align:right;">
0.34
</td>
<td style="text-align:right;">
0.33
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
69
</td>
</tr>
</tbody>
</table>
</div>
<div id="adaptation-results-variance-in-table-14.6" class="section level4 hasAnchor" number="14.0.10.2">
<h4><span class="header-section-number">14.0.10.2</span> Adaptation results: variance in Table 14.6<a href="estimation-external.html#adaptation-results-variance-in-table-14.6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As discussed above, the standard errors (SEs) from random effect pooling of literature data are notably smaller than those for the local univariate coefficients. The local multivariable coefficients have larger SEs, as always for logistic regression models (<a href="https://www.jstor.org/stable/1403444#metadata_info_tab_contents" title="Some Surprising Results about Covariate Adjustment in Logistic Regression Models">Robinson &amp; Jewell, 1991</a>).</p>
<p>The adaptation methods suggest substantially smaller SEs. For SEX the reduction is only 13%, reflecting the poor correlation between multivariable and univariable coefficients in the IPD (<em>r</em>=0.36). Over 50% reduction in variance is obtained for the other estimates; assuming a global prediction model holds with respect to the predictor effects.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="estimation-external.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Round the coefficients after shrinkage 0.9</span></span>
<span id="cb82-2"><a href="estimation-external.html#cb82-2" aria-hidden="true" tabindex="-1"></a>rounded.coef <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fl">0.9</span><span class="sc">*</span>adapt.coefficients,<span class="dv">1</span>)</span>
<span id="cb82-3"><a href="estimation-external.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># we estimate the intercept</span></span>
<span id="cb82-4"><a href="estimation-external.html#cb82-4" aria-hidden="true" tabindex="-1"></a>X   <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(full<span class="sc">$</span>x)</span>
<span id="cb82-5"><a href="estimation-external.html#cb82-5" aria-hidden="true" tabindex="-1"></a>X[,<span class="dv">2</span>] <span class="ot">&lt;-</span> X[,<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">7</span> <span class="co"># center around age=7 decades (70 years)</span></span>
<span id="cb82-6"><a href="estimation-external.html#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate linear predictor, used as offset in lrm.fit</span></span>
<span id="cb82-7"><a href="estimation-external.html#cb82-7" aria-hidden="true" tabindex="-1"></a>offset.AAA  <span class="ot">&lt;-</span> X <span class="sc">%*%</span> rounded.coef</span>
<span id="cb82-8"><a href="estimation-external.html#cb82-8" aria-hidden="true" tabindex="-1"></a>fit.offset  <span class="ot">&lt;-</span> <span class="fu">lrm.fit</span>(<span class="at">y=</span>full<span class="sc">$</span>y, <span class="at">offset=</span>offset.AAA)</span>
<span id="cb82-9"><a href="estimation-external.html#cb82-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalibrate baseline risk to 5% (odds(0.05.0.95)); observed was 18/238, or odds 18/220</span></span>
<span id="cb82-10"><a href="estimation-external.html#cb82-10" aria-hidden="true" tabindex="-1"></a>recal.intercept <span class="ot">&lt;-</span> fit.offset<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">log</span>((<span class="fl">0.05</span><span class="sc">/</span><span class="fl">0.95</span>)<span class="sc">/</span>(<span class="dv">18</span><span class="sc">/</span><span class="dv">220</span>))</span>
<span id="cb82-11"><a href="estimation-external.html#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="estimation-external.html#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################################</span></span>
<span id="cb82-13"><a href="estimation-external.html#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative, crude naive Bayes approach </span></span>
<span id="cb82-14"><a href="estimation-external.html#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Recalibrate literature coefficients with one calibration factor </span></span>
<span id="cb82-15"><a href="estimation-external.html#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate linear predictor, used as the only x variable in lrm.fit</span></span>
<span id="cb82-16"><a href="estimation-external.html#cb82-16" aria-hidden="true" tabindex="-1"></a>lit.score   <span class="ot">&lt;-</span> X <span class="sc">%*%</span> lit.coefficients</span>
<span id="cb82-17"><a href="estimation-external.html#cb82-17" aria-hidden="true" tabindex="-1"></a>fit.lit  <span class="ot">&lt;-</span> <span class="fu">lrm.fit</span>(<span class="at">y=</span>full<span class="sc">$</span>y, <span class="at">x=</span>lit.score)</span>
<span id="cb82-18"><a href="estimation-external.html#cb82-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-19"><a href="estimation-external.html#cb82-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit.lit, <span class="at">digits=</span><span class="dv">2</span>) <span class="co"># uni coefs model fit</span></span></code></pre></div>
</details>

 <strong>Logistic Regression Model</strong>
 
 <pre>
 lrm.fit(x = lit.score, y = full$y)
 </pre>
 
 <table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr>
<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; border-left: 1px solid black; border-right: 1px solid black; text-align: center;'></th>
<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; border-right: 1px solid black; text-align: center;'>Model Likelihood<br>Ratio Test</th>
<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; border-right: 1px solid black; text-align: center;'>Discrimination<br>Indexes</th>
<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; border-right: 1px solid black; text-align: center;'>Rank Discrim.<br>Indexes</th>
</tr>
</thead>
<tbody>
<tr>
<td style='min-width: 9em; border-left: 1px solid black; border-right: 1px solid black; text-align: center;'>Obs 238</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'>LR χ<sup>2</sup> 25.14</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'><i>R</i><sup>2</sup> 0.242</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'><i>C</i> 0.835</td>
</tr>
<tr>
<td style='min-width: 9em; border-left: 1px solid black; border-right: 1px solid black; text-align: center;'> 0 220</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'>d.f. 1</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'><i>R</i><sup><span style='font-size: 70%;'>2</span></sup><sub style='position: relative; left: -.47em; bottom: -.4em;'><span style='font-size: 70%;'>1,238</span></sub> 0.096</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'><i>D</i><sub>xy</sub> 0.669</td>
</tr>
<tr>
<td style='min-width: 9em; border-left: 1px solid black; border-right: 1px solid black; text-align: center;'> 1 18</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'>Pr(>χ<sup>2</sup>) <0.0001</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'><i>R</i><sup><span style='font-size: 70%;'>2</span></sup><sub style='position: relative; left: -.47em; bottom: -.4em;'><span style='font-size: 70%;'>1,49.9</span></sub> 0.384</td>
<td style='min-width: 9em; border-right: 1px solid black; text-align: center;'>γ 0.670</td>
</tr>
<tr>
<td style='min-width: 9em; border-bottom: 2px solid grey; border-left: 1px solid black; border-right: 1px solid black; text-align: center;'>max |∂log <i>L</i>/∂β| 1×10<sup>-8</sup></td>
<td style='min-width: 9em; border-bottom: 2px solid grey; border-right: 1px solid black; text-align: center;'></td>
<td style='min-width: 9em; border-bottom: 2px solid grey; border-right: 1px solid black; text-align: center;'>Brier 0.061</td>
<td style='min-width: 9em; border-bottom: 2px solid grey; border-right: 1px solid black; text-align: center;'>τ<sub>a</sub> 0.094</td>
</tr>
</tbody>
</table>

 
 <table class='gmisc_table' style='border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;' >
<thead>
<tr><th style='border-bottom: 1px solid grey; font-weight: 900; border-top: 2px solid grey; min-width: 7em; text-align: center;'></th>
<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: right;'>β</th>
<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: right;'>S.E.</th>
<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: right;'>Wald <i>Z</i></th>
<th style='font-weight: 900; border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: right;'>Pr(>|<i>Z</i>|)</th>
</tr>
</thead>
<tbody>
<tr>
<td style='min-width: 7em; text-align: left;'>Intercept</td>
<td style='min-width: 7em; text-align: right;'> -4.08</td>
<td style='min-width: 7em; text-align: right;'> 0.56</td>
<td style='min-width: 7em; text-align: right;'>-7.35</td>
<td style='min-width: 7em; text-align: right;'><0.0001</td>
</tr>
<tr>
<td style='min-width: 7em; border-bottom: 2px solid grey; text-align: left;'>x[1]</td>
<td style='min-width: 7em; border-bottom: 2px solid grey; text-align: right;'>  0.69</td>
<td style='min-width: 7em; border-bottom: 2px solid grey; text-align: right;'> 0.16</td>
<td style='min-width: 7em; border-bottom: 2px solid grey; text-align: right;'> 4.44</td>
<td style='min-width: 7em; border-bottom: 2px solid grey; text-align: right;'><0.0001</td>
</tr>
</tbody>
</table>

<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="estimation-external.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 formulas for risk calculation</span></span>
<span id="cb83-2"><a href="estimation-external.html#cb83-2" aria-hidden="true" tabindex="-1"></a>recal.intercept.lit <span class="ot">&lt;-</span> fit.lit<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">log</span>((<span class="fl">0.05</span><span class="sc">/</span><span class="fl">0.95</span>)<span class="sc">/</span>(<span class="dv">18</span><span class="sc">/</span><span class="dv">220</span>))</span>
<span id="cb83-3"><a href="estimation-external.html#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="estimation-external.html#cb83-4" aria-hidden="true" tabindex="-1"></a>tab14 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(full<span class="sc">$</span>coefficients, </span>
<span id="cb83-5"><a href="estimation-external.html#cb83-5" aria-hidden="true" tabindex="-1"></a>               full.penalized<span class="sc">$</span>coefficients, </span>
<span id="cb83-6"><a href="estimation-external.html#cb83-6" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(recal.intercept, rounded.coef),</span>
<span id="cb83-7"><a href="estimation-external.html#cb83-7" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(<span class="cn">NA</span>, lit.coefficients),</span>
<span id="cb83-8"><a href="estimation-external.html#cb83-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(recal.intercept.lit, fit.lit<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>lit.coefficients))</span>
<span id="cb83-9"><a href="estimation-external.html#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="estimation-external.html#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">names</span>(full<span class="sc">$</span>coefficients)</span>
<span id="cb83-11"><a href="estimation-external.html#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;full.coef&quot;</span>, <span class="st">&quot;penalized.m&quot;</span>, <span class="st">&quot;adapted&quot;</span>, <span class="st">&quot;lit coefs&quot;</span>, <span class="st">&quot;lit score&quot;</span>)</span>
<span id="cb83-12"><a href="estimation-external.html#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tab14, <span class="at">digits=</span><span class="dv">1</span>, </span>
<span id="cb83-13"><a href="estimation-external.html#cb83-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Rounded coefficients with IPD only, adaptation approach, or naive Bayes score&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:adaptation.score)Rounded coefficients with IPD only, adaptation approach, or naive Bayes score
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
full.coef
</th>
<th style="text-align:right;">
penalized.m
</th>
<th style="text-align:right;">
adapted
</th>
<th style="text-align:right;">
lit coefs
</th>
<th style="text-align:right;">
lit score
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Intercept
</td>
<td style="text-align:right;">
-8.1
</td>
<td style="text-align:right;">
-5.6
</td>
<td style="text-align:right;">
-4.1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
-4.5
</td>
</tr>
<tr>
<td style="text-align:left;">
SEX
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.2
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.3
</td>
</tr>
<tr>
<td style="text-align:left;">
AGE10
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
0.3
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
0.5
</td>
</tr>
<tr>
<td style="text-align:left;">
MI
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
0.5
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.7
</td>
</tr>
<tr>
<td style="text-align:left;">
CHF
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
1.6
</td>
<td style="text-align:right;">
1.1
</td>
</tr>
<tr>
<td style="text-align:left;">
ISCHEMIA
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
0.8
</td>
<td style="text-align:right;">
1.5
</td>
<td style="text-align:right;">
1.0
</td>
</tr>
<tr>
<td style="text-align:left;">
RENAL
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
0.7
</td>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
1.3
</td>
<td style="text-align:right;">
0.9
</td>
</tr>
<tr>
<td style="text-align:left;">
LUNG
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
0.4
</td>
<td style="text-align:right;">
0.6
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
0.6
</td>
</tr>
</tbody>
</table>
</div>
<div id="a-score-for-prediction-in-aaa-patients-table-14.6" class="section level4 hasAnchor" number="14.0.10.3">
<h4><span class="header-section-number">14.0.10.3</span> A score for prediction in AAA patients: Table 14.6<a href="estimation-external.html#a-score-for-prediction-in-aaa-patients-table-14.6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Prediction of mortality in AAA patients could be based on the simple full model estimates, based on maximum likelihood (<strong>full.coef)</strong>. Shrinkage or penalization leads to estimates closer to zero (<strong>penalized.m</strong>). The adaptation results were shrunk with an overall factor of 0.9, based on the empirical behavior in the GUSTO data set, as described in Table 14.3, section 14.1.9 of <em>Clinical Prediction Models</em>. The adapted estimates are rather somewhat in between the <strong>full.coef</strong> and <strong>penalized.m</strong>estimates, and are kind of compromise with the univariate literature estimates (<strong>lit coefs)</strong>. Smaller adapted estimates than in the penalized model are obtained for <code>MI</code> (history of a myocardial infarction), reflecting the finding of a univariate estimate of 1.5 in the IPD versus 1.0 in the literature.</p>
<p>An alternative approach is to calibrate a score based on the univariate literature coefficients. The calibration factor is 0.69, estimated by using the score as a single predictor:</p>
<p><code>lit.score  &lt;- X %*% lit.coefficients</code></p>
<p><code>fit.lit     &lt;- lrm.fit(y=full$y, x=lit.score)</code></p>
<p>Finally, we can calibrate the scores to an average risk of 5%. This recalibration was implemented by the log(odds ratio) for odds(5%) / odds(case study) to the estimated logistic regression model intercept :</p>
<p><code>fit.offset$coef[1] + log((0.05/0.95)/(18/220))</code></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="estimation-external.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit with adapted coefficients in score to obtain c statistics</span></span>
<span id="cb84-2"><a href="estimation-external.html#cb84-2" aria-hidden="true" tabindex="-1"></a>adapt.fit <span class="ot">&lt;-</span> <span class="fu">lrm.fit</span>(<span class="at">y=</span>full<span class="sc">$</span>y, <span class="at">x=</span>offset.AAA)</span>
<span id="cb84-3"><a href="estimation-external.html#cb84-3" aria-hidden="true" tabindex="-1"></a>tab14 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(full<span class="sc">$</span>stats[<span class="dv">6</span>], full.penalized<span class="sc">$</span>stats[<span class="dv">6</span>], adapt.fit<span class="sc">$</span>stats[<span class="dv">6</span>], fit.lit<span class="sc">$</span>stats[<span class="dv">6</span>]), <span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb84-4"><a href="estimation-external.html#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab14) <span class="ot">&lt;-</span> <span class="st">&quot;Apparent c statistic&quot;</span></span>
<span id="cb84-5"><a href="estimation-external.html#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;full.coef&quot;</span>, <span class="st">&quot;penalized.m&quot;</span>, <span class="st">&quot;adapted&quot;</span>, <span class="st">&quot;lit score&quot;</span>)</span>
<span id="cb84-6"><a href="estimation-external.html#cb84-6" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tab14, <span class="at">digits=</span><span class="dv">3</span>, <span class="at">caption =</span> <span class="st">&quot;C stats&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:adaptation.performance)C stats
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
full.coef
</th>
<th style="text-align:right;">
penalized.m
</th>
<th style="text-align:right;">
adapted
</th>
<th style="text-align:right;">
lit score
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Apparent c statistic
</td>
<td style="text-align:right;">
0.832
</td>
<td style="text-align:right;">
0.833
</td>
<td style="text-align:right;">
0.829
</td>
<td style="text-align:right;">
0.835
</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="estimation-external.html#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calibration</span></span>
<span id="cb85-2"><a href="estimation-external.html#cb85-2" aria-hidden="true" tabindex="-1"></a>tab14 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(adapt.fit<span class="sc">$</span>coef[<span class="dv">2</span>], <span class="dv">1</span><span class="sc">/</span>adapt.fit<span class="sc">$</span>coef[<span class="dv">2</span>] ), <span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb85-3"><a href="estimation-external.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tab14) <span class="ot">&lt;-</span> <span class="st">&quot;&quot;</span></span>
<span id="cb85-4"><a href="estimation-external.html#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tab14) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;adapted coefficient&quot;</span>, <span class="st">&quot;adapted effective shrinkage&quot;</span>)</span>
<span id="cb85-5"><a href="estimation-external.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tab14, <span class="at">digits=</span><span class="dv">3</span>, <span class="at">caption =</span> <span class="st">&quot;Calibration insights&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption>
(#tab:adaptation.performance)Calibration insights
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
adapted coefficient
</th>
<th style="text-align:right;">
adapted effective shrinkage
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
1.29
</td>
<td style="text-align:right;">
0.778
</td>
</tr>
</tbody>
</table>
<p>The apparent discriminative performance is all similar for these sets of coefficients, with c statistics around 0.83. We noted from the bootstrap procedure above that the internally validated estimate was 0.80 rather than 0.83. We do not know what the validated performance is for the model variants based on literature data (<strong>adapted</strong>; <strong>lit score</strong>).</p>
<p>For calibration, we noted that the estimated shrinkage factor for the full model was around 0.7. When we fit a model with adapted coefficients, the coefficient is 1.29; so an effective shrinkage of 1/1.29 = 0.78 was built in by considering the literature estimates in an adaptation approach.</p>
<hr />
</div>
</div>
</div>
<div id="conclusions" class="section level2 unnumbered hasAnchor">
<h2>Conclusions<a href="estimation-external.html#conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Findings from other studies can be used in various ways to develop a locally applicable prediction model.</p>
<ul>
<li><p>The modeling with <code>impact</code> data for TBI patients illustrated an IPD MA approach. A global model can readily be derived with a local baseline risk estimate.</p></li>
<li><p>The modeling with <code>AAA</code> data for aneurysm surgery illustrated two variants of adaptation approaches:</p>
<ol style="list-style-type: decimal">
<li>simple, subtracting the difference in IPD data between univariate and multivariable coefficient from univariate literature estimates;</li>
<li>a more sophisticated approach, with an optimized adaptation factor from a bootstrap procedure</li>
</ol></li>
<li><p>We can also recalibrate a simple score based on univariate literature coefficients. This is a variant of naive Bayes modeling.</p></li>
</ul>
<p>By definition, estimates that borrow information of other studies are more stable than per study estimates; the assumption is that the observed predictor associations in other studies are relevant for the local setting. For baseline risk, substantial heterogeneity was observed in the TBI case study. For the AAA study, calibration to an average risk of 5% was implemented.</p>
<p>Local validation studies are needed to confirm the applicability of prediction models; followed by updating where needed (<a href="https://pubmed.ncbi.nlm.nih.gov/36510134/" title="Methodological guidance for the evaluation and updating of clinical prediction models: a systematic review">Binuya 2022</a>).</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="estimation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="evaluation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
